function loadContent(e,t){var n=e.data();n.loadContent=!0;var i,o=void 0===n.destination?e.closest("section"):$(n.destination);void 0!==e.data("url")?i=e.data("url"):void 0!==e.attr("href")&&(i=e.attr("href"));var a=function(e){var n=void 0===e.content?e:e.content;o.html(n).css("visibility","visible").fadeIn(200),loadWYSIWYGEditor(),initCalendars(),void 0!==t&&t(e)};processAjax(o,n,a,i)}function modifyAccount(e){var t=e,n=t.length>0?$(t[0].form):$(),i=getData(n),o=$(e.data("destination")),a=(0===o.length?e.closest("section"):o,i[1].value),r=i[0].value,s=function(){var e=function(e){if(void 0!==o){var t=void 0===e.content?e:e.content;o.html(t).css("visibility","visible").fadeIn(200),loadWYSIWYGEditor(),initCalendars(),void 0!==final_callback&&final_callback(e)}};processAjax($("#user_list"),null,e,"php/router.php?controller=Users&action=generateuserslist")};if("deactivate"==a||"deleteUser"==a){var l="deactivate"==a?"deactivate":"delete";trigger_modal(t,!1),confirmationBox(t,"Are you sure you want to "+l+" the account of "+r+"?",l.toUpperCase(),function(e){processAjax($("#user_list"),{username:r},function(){t.modalTrigger("close"),s()},"php/router.php?controller=Users&action="+a)})}else processAjax($("#user_list"),{username:r},function(){s()},"php/router.php?controller=Users&action="+a);return!0}function actionOnSelect(e,t){var n=e.length>0?$(e[0].form):$();if(n.length>0)var i=getData(n);else i={},i[e.attr("name")]=e.val();var o=$(e.data("destination")),a=0===o.length?e.closest("section"):o,r=void 0!==e.data("url")?e.data("url"):n.attr("action"),s=function(e){if(void 0!==o){var n=void 0===e.content?e:e.content;o.html(n).css("visibility","visible").fadeIn(200),loadWYSIWYGEditor(),initCalendars(),void 0!==t&&t(e)}};processAjax(a,i,s,r)}function confirmationBox(e,t,n,i){trigger_modal(e,!1);var o=$(".modalContainer");o.find(".modal_section#confirmation_box").length>0&&o.find(".modal_section#confirmation_box").remove(),jQuery.ajax({type:"post",url:"php/router.php?controller=Modal&action=getBox&type=confirmation",data:{button_txt:n,text:t},async:!0,success:function(t){var n=jQuery.parseJSON(t);o.find(".popupBody").append(n),e.modalTrigger("showOverlay");var a=e.modalTrigger("getWindow");a.modalWindow("show_section","confirmation_box");var r=$(".modal_section#confirmation_box");r.find("input[name='confirmation']").click(function(){void 0!==i&&i()}),r.find("input[name='cancel']").click(function(){a.modalWindow("close")})}})}function dialogBox(e,t,n,i){trigger_modal(e,!1),void 0===n&&(n="");var o=$(".modalContainer");o.find(".modal_section#confirmation_box").length>0&&o.find(".modal_section#confirmation_box").remove(),jQuery.ajax({type:"post",url:"php/router.php?controller=Modal&action=getBox&type=dialog",data:{text:t,title:n},async:!0,success:function(t){var n=jQuery.parseJSON(t);o.find(".popupBody").append(n),e.modalTrigger("showOverlay");var a=e.modalTrigger("getWindow");a.modalWindow("show_section","confirmation_box");var r=$(".modal_section#confirmation_box");r.find(".callback_trigger").click(function(){i($(this))}),r.find("input[name='cancel']").click(function(){a.modalWindow("close")})}})}function loadWYSIWYGEditor(){var e=$(document).find("textarea.wygiwym");$.each(e,function(e,t){CKEDITOR.instances[$(t).attr("id")]&&CKEDITOR.instances[$(t).attr("id")].destroy(),CKEDITOR.replace(t)})}function removeDatePicker(){jQuery("#ui-datepicker-div").remove(),$(".hasDatepicker").removeClass("hasDatepicker"),$(".datepicker").datepicker("destroy"),$(".datepicker").datepicker()}function initViewerCalendar(e,t){e.datepicker({defaultDate:selected,firstDay:1,dateFormat:"yy-mm-dd",inline:!0,showOtherMonths:!0,beforeShowDay:function(e){return renderCalendarCallback(e,t,!0)}})}function initSubmissionCalendar(e,t){e.datepicker({defaultDate:selected,firstDay:1,dateFormat:"yy-mm-dd",inline:!0,showOtherMonths:!0,beforeShowDay:function(e){return renderCalendarCallback(e,t,!1)},onSelect:function(e,t){refresh_date(t,planned_sessions[e])}})}function renderCalendarCallback(e,t,n){var i=(e.getDay(),$.datepicker.formatDate("dd-mm-yy",e)),o=$.inArray(i,t.booked),a=[],r=null,s=n;if(o>-1){planned_sessions[$.datepicker.formatDate("yy-mm-dd",e)]=t.session_id[o];var l=t.slots[o]-t.nb[o],c=t.renderTypes[o];r=c+": ("+l+" slot(s) available)",s=l>0||n,0===t.nb[o]?a.push("jc_day"):t.nb[o]<t.slots[o]?a.push("jc_day jc_day_rem"):(a.push("jc_day full_day"),r=c+": Booked out");var u=$.inArray(i,t.Assignments);u>-1&&(a.push("assigned"),r="You are presenting this day")}else r="No session planned on this day";var d=$.inArray(i,t.Availability);return d>-1&&(a.push("not_available"),r="You are not available this day"),a=a.length>0?a.join(" "):"",[s,a,r]}function refresh_date(e,t){var n=$(e.input[0].form),i=n.find('input[name="session_id"]');void 0!==i&&i.length>0?i.val(t):n.append("<input type='hidden' name='session_id' value='"+t+"' />")}function addRecipients(e){var t=$(".select_emails_selector"),n=$(".select_emails_container"),i=t.length>0?$(t[0].form):$(),o=t.val(),a=n.find(".select_emails_list");n.find(".select_emails_list").find(".mailing_recipients_empty").remove();var r=i.find("input[name='emails']");jQuery.ajax({url:"php/router.php?controller=MailManager&action=addRecipients",type:"post",data:{add_emails:o},async:!0,success:function(e){var t=jQuery.parseJSON(e);if(t.status){if(void 0!==r&&r.length>0){var n=r.val().split(",");n.push(t.ids),n=""===n[0]?n.slice(1,n.length):n,r.val(n.join(","))}else i.append("<input name='emails' type='hidden' value='"+t.ids+"'/>");a.append(t.content)}}})}function sendToRecipients(e){var t=e.length>0?$(e[0].form):$(),n=$(".select_emails_container").find(".select_emails_list");if(n.find(".mailing_recipients_empty").remove(),!$.trim(n.html()).length)return n.html('<p class="mailing_recipients_empty sys_msg warning leanmodal" id="warning">You must select recipients before sending your email!</p>'),!0;if(!checkform(t))return!1;var i=function(){var n=getData(t),i=[];t.find("input.upl_link").each(function(){i.push($(this).val())}),i=i.join(","),n=modArray(n,"attachments",i);var o=function(){e.data("url","php/router.php?controller=MailManager&action=getContactForm"),e.data("destination",".mailing_container"),loadContent(e)};processAjax($(".mailing_container"),n,o,"php/router.php?controller=MailManager&action=sendToRecipients")};if("yes"===$("#make_news").val()){trigger_modal($(this));var o='The option "Add as news" is set to "Yes", which means the content of your email will be published as a news. Do you want to continue?';confirmationBox($(this),o,"Continue",i)}else i();return!0}function testEmailSettings(e){var t=e.length>0?$(e[0].form):$(),n=t.serializeArray();processAjax(t,n,!1,"php/router.php?controller=MailManager&action=sendTestEmail")}function logout(){0===logoutContainer.length&&($("body").append(logoutTemplate),logoutContainer=$(".logoutWarning")),login_start=null,login_expire=null,jQuery.ajax({url:"php/router.php?controller=SessionInstance&action=destroy",type:"POST",async:!0,success:function(e){var t=jQuery.parseJSON(e);logoutContainer.find(".logout_msg").html("You have been logged out"),logoutContainer.find(".logout_button").html("OK"),logoutContainer.fadeIn(200),setTimeout(function(){logoutContainer.fadeOut(200).empty().hide(),window.location=t},3e3)}})}function check_login(){jQuery.ajax({url:"php/router.php?controller=SessionInstance&action=checkLogin",type:"post",async:!0,success:function(e){var t=jQuery.parseJSON(e);t!==!1&&(login_start=t.start,login_expired=t.expired,login_warning=t.warning,login_remaining=t.remaining,!login_expired&login_remaining<=login_warning&&login_remaining>0?displaySessionTimeOut(login_remaining):(login_expired||login_remaining<0)&&logout())}})}function displaySessionTimeOut(e){0===logoutContainer.length&&($("body").append(logoutTemplate),logoutContainer=$(".logoutWarning"));var t=1e3*Math.round(e),n=new Date(t),i=n.getUTCMinutes()<10?"0"+n.getUTCMinutes():n.getUTCMinutes(),o=n.getUTCSeconds()<10?"0"+n.getUTCSeconds():n.getUTCSeconds();logoutContainer.find(".logout_msg").html("You will be automatically logged out in "+i+":"+o+" due to inactivity"),logoutContainer.find(".logout_button").addClass("extend_session").html("Extend"),logoutContainer.is(":visible")||logoutContainer.fadeIn(200)}function extend_session(){jQuery.ajax({url:"php/router.php?controller=SessionInstance&action=extendSession",type:"post",async:!0,success:function(e){var t=jQuery.parseJSON(e);t!==!1&&(login_start=t.start,login_expire=t.expire,login_warning=t.warning,logoutContainer.hide())}})}function popLogin(){$("#login_button").click()}function process_email(){var e=$(this).length>0?$($(this)[0].form):$(),t=$(".mailing_container"),n=$(".select_emails_container").find(".select_emails_list");if(n.find(".mailing_recipients_empty").remove(),!$.trim(n.html()).length)return n.html('<p class="mailing_recipients_empty sys_msg warning leanmodal" id="warning">You must select recipients before sending your email!</p>'),!0;if(!checkform(e))return!1;var i=function(){var n=e.serializeArray(),i=tinyMCE.get("spec_msg").getContent(),o=[];e.find("input.upl_link").each(function(){o.push($(this).val())}),o=o.join(","),n=modArray(n,"body",i),n=modArray(n,"attachments",o),processAjax(t,n,null,"php/form.php")};$(".select_emails_selector").val();if("yes"===$("#make_news").val()){trigger_modal($(this));var o='The option "Add as news" is set to "Yes", which means the content of your email will be published as a news. Do you want to continue?';confirmationBox($(this),o,"Continue",i)}else i(),close_modal();return!0}function realWidth(e){var t=e.clone();t.css("visibility","hidden"),$("body").append(t);var n=t.outerWidth();return t.remove(),n}function clear_active_submenu(){$(".submenu").is(":visible")&&$(".submenu").hide(),$(".submenu_trigger").each(function(){$(this).parent("li").removeClass("active_submenu")})}function show_submenu(e){var t=e.parent("li");if(t.hasClass("active_submenu"))return!0;clear_active_submenu(),t.addClass("active_submenu");var n,i=t.position(),o=t.outerHeight(),a=e.attr("id");e.closest("div").hasClass("sideMenu")?(n=$(".sideMenu nav.submenu#"+a),n.toggle(200)):(n=$(".topnav nav.submenu#"+a),n.css({left:i.left+"px",top:i.top+o+"px"}).toggle(200))}function process_vote(e){if(null===login_start)return popLogin(),!1;var t=e.parent(".vote_container"),n=t.data();n.process_vote=!0,jQuery.ajax({url:"php/router.php?controller=Vote&action="+n.operation,data:n,type:"post",async:!0,success:function(n){var i=jQuery.parseJSON(n);i.status!==!1&&(i.state?(e.toggleClass("vote_default vote_liked"),t.data("operation","delete"),t.attr("data-operation","delete")):(e.toggleClass("vote_liked vote_default"),t.data("operation","add"),t.attr("data-operation","add")),e.next().html(i.count))}})}function process_bookmark(e){var t=e.data();t.process_vote=!0,jQuery.ajax({url:"php/router.php?controller=Bookmark&action="+t.operation,data:t,type:"post",async:!0,success:function(t){var n=jQuery.parseJSON(t);n.status===!0&&(n.state?(e.toggleClass("bookmark_off bookmark_on"),e.attr("data-operation","delete"),e.data("operation","delete")):(e.toggleClass("bookmark_on bookmark_off"),e.attr("data-operation","add"),e.data("operation","add")))}})}function process_post(e,t){t.preventDefault();var n=e.length>0?$(e[0].form):$();if(!checkform(n))return!1;var i=n.find(".upl_link");if(i[0]){var o=[];i.each(function(){var e=$(this).val();o.push(e)}),o=o.join(","),n.append("<input type='hidden' name='link' value='"+o+"'>")}var a=getData(n),r=(n.find('input[name="controller"]').val(),function(e){if(e.status!==!0)return!1;var t=n.closest(".modal_section"),i=t.attr("id");$("section#"+container_id+", .modal_section#"+container_id).empty();var o=n.find('input[name="id"]').val().length>0&&n.find('input[name="id"]').length>0?n.find('input[name="id"]').val():void 0,a=void 0!==o?"edit":"new";get_submission_form({controller:i,action:"get_form",operation:a,id:o,destination:"#"+i.toLowerCase()+"_container"})}),s=n.find(".wygiwgm");is_editor_active(s)&&tinyMCE.get(s.attr("id")).getContent().length>0&&s.each(function(){var e=tinyMCE.get($(this).attr("id")).getContent();a=modArray(a,$(this).attr("name"),e)}),processAjax(e.closest(".form_container"),a,r,"php/form.php"),t.stopImmediatePropagation()}function process_submission(e,t){t.preventDefault();var n=e.length>0?$(e[0].form):$();if(!checkform(n))return!1;var i=(n.find("select[name='type']").val(),n.find("input[type=date]"));if(void 0!==i&&i.length>0){var o=i.val();if(void 0===o||0===o.length)return showfeedback('<p id="warning">You must choose a date!</p>'),i.focus(),!1}var a=n.find(".upl_link");if(a[0]){var r=[];a.each(function(){var e=$(this).val();r.push(e)}),r=r.join(","),n.append("<input type='hidden' name='media' value='"+r+"'>")}var s=getData(n),l=function(e){return e.status===!0&&void location.reload()};processAjax(e.closest(".form_container"),s,l,n.attr("action")),t.stopImmediatePropagation()}function addType(e){var t=e.attr("data-class"),n=$("input#new_"+t.toLowerCase()+"_type"),i=n.val(),o=$(".type_list#"+t.toLowerCase());return e.hasClass("wrongField")&&e.removeClass("wrongField"),0===i.length?(e.siblings("input").addClass("wrongField"),!0):void jQuery.ajax({url:"php/router.php?controller=TypesManager&action=addType&className="+t+"&type="+i,type:"POST",async:!0,beforeSend:function(){e.toggleClass("addBtn loadBtn")},complete:function(){e.toggleClass("addBtn loadBtn")},success:function(e){var t=jQuery.parseJSON(e);1==t.status?(o.html(t.msg),n.empty()):validsubmitform(o,t)}})}function deleteType(e){var t=e.attr("data-type"),n=e.attr("data-class"),i=$(".type_list#"+n.toLowerCase());jQuery.ajax({url:"php/router.php?controller=TypesManager&action=deleteType&className="+n+"&type="+t,type:"POST",async:!0,beforeSend:function(){e.addClass("loadBtn")},complete:function(){e.removeClass("loadBtn")},success:function(e){var t=jQuery.parseJSON(e);t.status!==!1?i.html(t):validsubmitform(i,t)}})}var get_submission_form=function(e){void 0===e.id&&(e.id=!1),void 0===e.operation&&(e.operation="new"),void 0===e.date&&(e.date=!1),void 0===e.type&&(e.type=!1),void 0===e.view&&(e.view="body");var t=void 0===e.destination?$(".submission_container"):$(e.destination),n=function(e){t.html(e).fadeIn(200).find("textarea").html(e.content),loadWYSIWYGEditor(),initCalendars()},i="php/router.php?controller="+controller+"&action=getForm";processAjax(t,e,n,i)},Editor="CKEditor",tinymcesetup=function(e){void 0===e&&(e="tinymce"),tinyMCE.remove(),window.tinymce.dom.Event.domLoaded=!0,tinymce.init({mode:"textareas",editor_selector:e,width:"100%",height:300,plugins:["advlist autolink lists charmap print preview hr spellchecker","searchreplace wordcount visualblocks visualchars code fullscreen","save contextmenu directionality template paste textcolor"],content_css:"vendor/tinymce/tinymce/skins/lightgray/content.min.css",toolbar:"undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | l      ink image | print preview media fullpage | forecolor backcolor emoticons"}),$("."+e).each(function(){void 0!==$(this).attr("id")&&0!==$(this).attr("id").length||$(this).attr("id","tinymce_"+Math.round((new Date).getTime()+100*Math.random())),tinyMCE.execCommand("mceAddControl",!0,$(this).attr("id"))})},selected=(new Date).getTime(),initCalendars=function(){removeDatePicker(),jQuery.ajax({url:"php/router.php?controller=Calendar&action=getData",type:"POST",async:!0,success:function(e){var t=jQuery.parseJSON(e);$(".datepicker").each(function(){formid=$(this),formid.hasClass("hasDatepicker")&&formid.datepicker("destroy"),$(this).hasClass("submissionCalendar")?initSubmissionCalendar($(this),t):$(this).hasClass("viewerCalendar")?initViewerCalendar($(this),t):"availabilityCalendar"==$(this).attr("id")&&initAvailabilityCalendar($(this),t)})}})},initAvailabilityCalendar=function(e,t){e.css({position:"relative","min-height":"200px"}),e.datepicker({defaultDate:selected,onSelect:function(e,t){selected=$(this).datepicker("getDate").getTime(),jQuery.ajax({url:"php/router.php?controller=Availability&action=updateUserAvailability&date="+e,type:"post",async:!0,success:function(){initCalendars()}})},firstDay:1,dateFormat:"yy-mm-dd",inline:!0,showOtherMonths:!0,beforeShowDay:function(e){return renderCalendarCallback(e,t,!0)}})},loadCalendarAvailability=function(){var e=$("#availability_calendar");e.length>0&&void 0!==e&&(e.css({position:"relative","min-height":"200px"}),jQuery.ajax({url:"php/router.php?controller=Calendar&action=getCalendarParams",type:"POST",async:!0,beforeSend:function(){loadingDiv(e)},complete:function(){removeLoading(e)},success:function(t){e.hasClass("hasDatepicker")&&e.datepicker("destroy"),initAvailabilityCalendar(jQuery.parseJSON(t))}}))},planned_sessions={},logoutTemplate="<div class='logoutWarning'><div class='logout_msg'></div><div class='logout_button'>OK</div></div>",login_start=null,login_expire=null,login_warning=null,logoutContainer=$(".logoutWarning"),modalpubform=$(".modal_section#submission_form");$(document).ready(function(){setInterval(check_login,5e3),$(document).on("click","#float_menu",function(){var e=$(this).position(),t=$(this).outerHeight(),n=$(window).height();$(".sideMenu").css({top:t+"px",left:e.left+"px",height:n-t+"px","max-height":n-t+"px"}).animate({width:"toggle"})}).on("mouseover",".submenu_trigger",function(e){e.preventDefault(),show_submenu($(this))}).on("click",".menu-section",function(e){e.preventDefault(),e.stopPropagation();var t=$(this).find("a");if($(".menu-section").each(function(){$(this).removeClass("activepage")}),$(this).addClass("activepage"),t.is("[id]")){var n=t.attr("href"),i=n.split("&"),o=i[0].split("="),a=o[1],r=!!t.is("[data-param]")&&t.attr("data-param");getPage(a,r),$(".submenu, .dropdown").hide()}var s=$(".sideMenu");s.is(":visible")&&s.animate({width:"toggle"})}).click(function(e){var t=$("nav"),n=$(".sideMenu"),i=$("#float_menu");i.is(e.target)||0!==i.has(e.target).length||(t.is(e.target)||0!==t.has(e.target).length||($(".submenu").hide(),clear_active_submenu()),n.is(":visible")&&!n.is(e.target)&&0===n.has(e.target).length&&n.animate({width:"toggle"}))}).on("mouseenter","#core, .submission",function(e){e.preventDefault()}).on("change","#availability_calendar",function(){alert($(this).val())}).on("click",".change_pwd",function(e){e.preventDefault();var t=function(e){var t=jQuery.parseJSON(e);trigger_modal($(this),!1),dialogBox($(this),t,"Modify event")};processAjax($(this).closest("form"),void 0,t,"php/router.php?controller=Users&action=requestPasswordChange&email="+$(this).attr("id"))}).on("click",".conf_changepw",function(e){e.preventDefault();var t=$(this),n=t.length>0?$(t[0].form):$(),i=function(e){e.status===!0&&setTimeout(logout,2e3)};processForm(n,i,n.attr("action"))}).on("click",".user_select",function(e){e.preventDefault();var t=$(this).data("filter"),n=function(e){$("#user_list").html(e)};processAjax($("#user_list"),void 0,n,"php/router.php?controller=Users&action=generateuserslist&filter="+t)}).on("change",".account_action",function(e){e.preventDefault(),modifyAccount($(this))}).on("click",".test_email_settings",function(e){e.preventDefault(),testEmailSettings($(this))}).on("change",".select_emails_selector",function(e){e.preventDefault(),addRecipients($(this))}).on("click",".added_email_delete",function(e){var t=$(this).closest("form"),n=$(this).attr("id"),i=$(".added_email#"+n),o=t.find("input[name='emails']"),a=o.val().split(","),r=a.indexOf(n);r>-1&&a.splice(r,1),o.val(a.join(",")),i.remove()}).on("click",".mailing_send",function(e){e.preventDefault(),sendToRecipients($(this))}).on("click",".show_log",function(e){e.preventDefault();var t=$(this);loadContent(t,function(e){$(".log_list_item_container").each(function(){$(this).removeClass("log_list_active")});var n=(t.closest(".log_container").attr("id"),t.closest(".log_list_item_container"));n.addClass("log_list_active")})}).on("click",".search_log",function(e){e.preventDefault();var t=$(this),n=t.length>0?$(t[0].form):$();t.data({url:n.attr("action")+n.find("input[name='search']").val(),destination:".log_content_container#"+$(this).attr("id")}),loadContent(t)}).on("click",".type_add",function(e){e.preventDefault(),addType($(this))}).on("click",".type_del",function(e){e.preventDefault(),deleteType($(this))}).on("change",".repeated_session",function(e){var t=$(this).val(),n=$(this).length>0?$($(this)[0].form):$(),i=n.find(".settings_hidden");1==t?i.each(function(){$(this).fadeIn()}):i.each(function(){$(this).fadeOut()})}).on("change",".selectSession",function(e){e.preventDefault(),$(this).removeData("datepicker").data("date",$(this).val()),loadContent($(this))}).on("change",".modSpeaker",function(){processAjax($(this).closest(".form-group"),{speaker:$(this).val(),presid:$(this).data("id")},!1,"php/router.php?controller=SessionManager&action=modifySpeaker")}).on("submit","form",function(e){checkform($(this))||e.stopPropagation()}).on("click",".modify_session",function(e){e.preventDefault();var t=$(this),n=t.length>0?$(t[0].form):$(),i=n.find('input[name="id"]').val(),o=n.attr("action"),a=function(e){0===n.find('input[name="operation"]').length?n.append("<input type='hidden' name='operation' value='"+e+"' />"):n.find('input[name="operation"]').attr("value",e);var i=getData(n);processAjax(n,i,function(){t.modalTrigger("close")},o)};jQuery.ajax({url:"php/router.php?controller=Session&action=isRecurrent&id="+i,type:"post",async:!0,success:function(e){if(jQuery.parseJSON(e)===!0){trigger_modal(t,!1);var n="<p>This event is recurrent</p>. <input type='submit' value='Modify this occurrence only' class='callback_trigger' data-operation='present'/><input type='submit' value='Modify all future occurrences' class='callback_trigger' data-operation='future'/><input type='submit' value='Modify all occurrences' class='callback_trigger' data-operation='all'/>";dialogBox(t,n,"Modify event",function(e){a(e.data("operation"))})}else a("present")}})}).on("click",".delete_session",function(e){e.preventDefault();var t=$(this).length>0?$($(this)[0].form):$(),n=t.find('input[name="id"]').val(),i=$(this),o=function(e,n){processAjax(t,t.serializeArray(),function(){i.modalTrigger("close")},"php/router.php?controller=SessionManager&action=deleteSession&id="+n+"&operation="+e)};jQuery.ajax({url:"php/router.php?controller=Session&action=isRecurrent&id="+n,type:"post",async:!0,success:function(e){if(jQuery.parseJSON(e)===!0){trigger_modal(i,!1);var t="<p>This event is recurrent</p>. <input type='submit' value='Delete this occurrence only' class='callback_trigger' data-operation='present'/><input type='submit' value='Delete all future occurrences' class='callback_trigger' data-operation='future'/><input type='submit' value='Delete all occurrences' class='callback_trigger' data-operation='all'/>";dialogBox(i,t,"Delete event",function(e){o(e.data("operation"),n)})}else confirmationBox(i,"Are you sure you want to delete this session?","Delete",function(){o("present",n)})}})}).on("change",".mod_session_type",function(e){e.preventDefault();var t=$(this).val(),n=$(this).closest(".session_div"),i=n.data("id");processAjax(n,data,null,"php/router.php?controller=Session&action=modifySessionType&id="+i+"type="+t)}).on("change",".archive_select",function(e){e.preventDefault();var t=$(this).val(),n=function(e){$("#archives_list").html(e)};processAjax($("#archives_list"),void 0,n,$(this).data("url")+"&year="+t)}).on("change","#select_wish",function(e){e.preventDefault(),$(this).data("id",$(this).val()),loadContent($(this))}).on("click",".loadContent",function(e){e.preventDefault(),loadContent($(this))}).on("change",".actionOnSelect",function(e){e.preventDefault(),actionOnSelect($(this))}).on("click",".select_suggestion",function(e){e.preventDefault(),get_submission_form($(this).data())}).on("click",".dl_btn",function(){$(".dlmenu").toggle()}).on("click",".link_name",function(){var e=$(this).attr("id"),t="uploads/"+e;window.open(t,"_blank")}).on("change",".change_pres_type",function(e){e.preventDefault();var t=($(this).length>0?$($(this)[0].form):$(),$(this).val()),n=$(this).attr("id").split("_"),i=n[0],o=n[1],a=function(e){$(".special_inputs_container").html(e)},r={getFormContent:t,controller:i,id:o};processAjax($(".special_inputs_container"),r,a,"php/router.php?controller="+i+"&action=getFormContent&type="+t+"&id="+o)}).on("click",".submit_pres",function(e){process_submission($(this),e)}).on("click",".vote_icon",function(){process_vote($(this))}).on("click",".bookmark_container",function(){process_bookmark($(this))}).on("click","#logout",function(e){e.preventDefault(),logout()}).on("click",".logout_button",function(){$(".logoutWarning").fadeOut(200).toggle()}).on("click",".extend_session",function(){extend_session()}).on("click",".get_suggestion_list",function(e){var t={get_suggestion_list:!0},n=function(e){modalpubform.html(e).fadeIn(200)};processAjax(modalpubform,t,n,"php/form.php")}).on("click",".load_content",function(e){e.preventDefault();for(var t=$(this).attr("href"),n=t.split("?"),i=n[1].split("&"),o={},a=0;a<i.length;a++){var r=i[a].split("=");o[r[0]]=r[1]}var s=void 0!==o.op&&o.op;if("wishpick"===s){var l={get_suggestion_list:!0},c=function(e){el.html(e).fadeIn(200)};processAjax(el,l,c,"php/form.php")}else get_submission_form($(this).data())}).on("mouseover",".leanModal",function(e){e.preventDefault();var t=function(){loadWYSIWYGEditor(),initCalendars()};trigger_modal($(this),!0,t)}).on("click",".go_to_section",function(e){e.preventDefault(),$(this).closest(".modalContainer").modalWindow("go_to_section",$(this).data())}).on("click",".modal_trigger_changepw",function(e){e.preventDefault(),$(this).modalTrigger("show_section","user_changepw")}).on("click",".back_btn",function(e){return e.preventDefault(),$(this).closest(".modalContainer").modalWindow("go_to_previous",$(this).data("prev")),!1}).on("click",".show_section",function(e){e.preventDefault(),$(this).modalTrigger("load_section",$(this).data())}).on("click",".delete",function(e){e.preventDefault();var t=$(this),n=void 0!==t.data("action")?t.data("action"):"delete",i=void 0!==t.data("controller")?"php/router.php?controller="+t.data("controller")+"&action="+n:t.attr("href");confirmationBox(t,"Are you sure you want to delete this item?","Delete",function(){jQuery.ajax({url:i,type:"post",data:{id:t.data("id")},async:!0,success:function(e){var n=jQuery.parseJSON(e);n===!0||n.hasOwnProperty("status")&&n.status===!0?(showfeedback("<div class='sys_msg success'>Item deleted</div>",".confirmation_text"),setTimeout(function(){t.modalTrigger("close"),location.reload()},2e3)):showfeedback("<div class='sys_msg warning'>Item could not be deleted</div>",".confirmation_text",!1)}})})}).on("click",".user_delete",function(e){e.preventDefault();var t=$(this);confirmationBox(t,"Are you sure you want to delete your account?","Delete my account",function(){jQuery.ajax({url:"php/router.php?controller=Users&action=deleteUser&username="+t.data("username"),type:"post",async:!0,success:function(e){var n=jQuery.parseJSON(e);n===!0||n.hasOwnProperty("status")&&n.status===!0?(showfeedback("<div class='sys_msg success'>Account successfully deleted. You are going to be logged out.</div>",".confirmation_text"),setTimeout(function(){t.modalTrigger("close"),location.reload()},2e3)):showfeedback("<div class='sys_msg warning'>Sorry, we could not delete your account. Please, try later.</div>",".confirmation_text",!1)}})})}).on("click"," .login",function(e){e.preventDefault();var t=$(this),n=t.length>0?$(t[0].form):$(),i=function(e){e.status===!0&&location.reload()};processForm(n,i,"reload"),e.stopImmediatePropagation()}).on("click",".register",function(e){e.preventDefault();var t=$(this),n=t.length>0?$(t[0].form):$(),i=function(e){e.status===!0&&t.modalTrigger("close")};processForm(n,i),e.stopImmediatePropagation()})});