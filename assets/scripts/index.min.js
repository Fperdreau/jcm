function loadContent(t,e){var n=t.data();n.loadContent=!0;var o,a=void 0===n.destination?t.closest("section"):$(n.destination);o=void 0!==t.data("url")?t.data("url"):void 0!==t.attr("href")?t.attr("href"):"php/form.php";var i=function(t){var n=void 0===t.content?t:t.content;a.html(n).css("visibility","visible").fadeIn(200),loadWYSIWYGEditor(),loadCalendarSubmission(),void 0!==e&&e(t)};processAjax(a,n,i,o)}function confirmation_box(t,e,n,o){trigger_modal(t,!1);var a=$(".modalContainer");a.find(".modal_section#confirmation_box").length>0&&a.find(".modal_section#confirmation_box").remove(),jQuery.ajax({type:"post",url:"php/router.php?controller=Modal&action=get_box&type=confirmation",data:{button_txt:n,text:e},async:!0,success:function(e){var n=jQuery.parseJSON(e);a.find(".popupBody").append(n),t.modalTrigger("showOverlay");var i=t.modalTrigger("getWindow");i.modalWindow("show_section","confirmation_box");var s=$(".modal_section#confirmation_box");s.find("input[name='confirmation']").click(function(){void 0!==o&&o()}),s.find("input[name='cancel']").click(function(){i.modalWindow("close")})}})}function dialog_box(t,e,n,o){trigger_modal(t,!1),void 0===n&&(n="");var a=$(".modalContainer");a.find(".modal_section#confirmation_box").length>0&&a.find(".modal_section#confirmation_box").remove(),jQuery.ajax({type:"post",url:"php/router.php?controller=Modal&action=get_box&type=dialog",data:{text:e,title:n},async:!0,success:function(e){var n=jQuery.parseJSON(e);a.find(".popupBody").append(n),t.modalTrigger("showOverlay");var i=t.modalTrigger("getWindow");i.modalWindow("show_section","confirmation_box");var s=$(".modal_section#confirmation_box");s.find(".callback_trigger").click(function(){o($(this))}),s.find("input[name='cancel']").click(function(){i.modalWindow("close")})}})}function removeDatePicker(){jQuery("#ui-datepicker-div").remove()}function renderCalendarCallback(t,e,n){var o=(t.getDay(),$.datepicker.formatDate("dd-mm-yy",t)),a=$.inArray(o,e.booked),i=null,s=null,r=n;if(a>-1){i=[],planned_sessions[$.datepicker.formatDate("yy-mm-dd",t)]=e.session_id[a];var l=e.slots[a]-e.nb[a],c=e.renderTypes[a];s=c+": ("+l+" slot(s) available)",r=l>0||n,0===e.nb[a]?i.push("jc_day"):e.nb[a]<e.slots[a]?i.push("jc_day jc_day_rem"):(i.push("jc_day full_day"),s=c+": Booked out");var u=$.inArray(o,e.Availability);u>-1&&(i.push("not_available"),s="You are not available this day");var d=$.inArray(o,e.Assignments);return d>-1&&(i.push("assigned"),s="You are presenting this day"),i=i.join(" "),[r,i,s]}return[r,"","No session planned on this day"]}function refresh_date(t,e){var n=$(t.input[0].form),o=n.find('input[name="session_id"]');void 0!==o&&o.length>0?o.val(e):n.append("<input type='hidden' name='session_id' value='"+e+"' />")}function addRecipients(t){var e=$(".select_emails_selector"),n=$(".select_emails_container"),o=e.length>0?$(e[0].form):$(),a=e.val(),i=n.find(".select_emails_list");n.find(".select_emails_list").find(".mailing_recipients_empty").remove();var s=o.find("input[name='emails']");jQuery.ajax({url:"php/router.php?controller=MailManager&action=addRecipients",type:"post",data:{add_emails:a},async:!0,success:function(t){var e=jQuery.parseJSON(t);if(e.status){if(void 0!==s&&s.length>0){var n=s.val().split(",");n.push(e.ids),n=""===n[0]?n.slice(1,n.length):n,s.val(n.join(","))}else o.append("<input name='emails' type='hidden' value='"+e.ids+"'/>");i.append(e.content)}}})}function sendToRecipients(t){var e=t.length>0?$(t[0].form):$(),n=$(".select_emails_container").find(".select_emails_list");if(n.find(".mailing_recipients_empty").remove(),!$.trim(n.html()).length)return n.html('<p class="mailing_recipients_empty sys_msg warning leanmodal" id="warning">You must select recipients before sending your email!</p>'),!0;if(!checkform(e))return!1;var o=function(){var t=getData(e),n=[];e.find("input.upl_link").each(function(){n.push($(this).val())}),n=n.join(","),t=modArray(t,"attachments",n),processAjax($(".mailing_container"),t,!1,"php/router.php?controller=MailManager&action=sendToRecipients")};if("yes"===$("#make_news").val()){trigger_modal($(this));var a='The option "Add as news" is set to "Yes", which means the content of your email will be published as a news. Do you want to continue?';confirmation_box($(this),a,"Continue",o)}else o();return!0}function testEmailSettings(t){var e=t.length>0?$(t[0].form):$(),n=e.serializeArray();processAjax(e,n,!1,"php/router.php?controller=MailManager&action=send_test_email")}function check_login(){if(0===logoutContainer.length&&($("body").append(logoutTemplate),logoutContainer=$(".logoutWarning")),null===login_start)jQuery.ajax({url:"php/form.php",data:{check_login:!0},type:"post",async:!0,success:function(t){var e=jQuery.parseJSON(t);e!==!1&&(login_start=e.start,login_expire=e.expire,login_warning=e.warning)}});else{var t=Math.floor((new Date).getTime()/1e3),e=login_expire-t;if(e<=login_warning&&e>0){var n=1e3*Math.round(e),o=new Date(n),a=o.getUTCMinutes()<10?"0"+o.getUTCMinutes():o.getUTCMinutes(),i=o.getUTCSeconds()<10?"0"+o.getUTCSeconds():o.getUTCSeconds();logoutContainer.find(".logout_msg").html("You will be automatically logged out in "+a+":"+i+" due to inactivity"),logoutContainer.find(".logout_button").addClass("extend_session").html("Extend"),logoutContainer.is(":visible")||logoutContainer.fadeIn(200)}else e<0&&logout()}}function extend_session(){jQuery.ajax({url:"php/router.php?controller=Auth&action=extend_login",type:"post",async:!0,success:function(t){var e=jQuery.parseJSON(t);e!==!1&&(login_start=e.start,login_expire=e.expire,login_warning=e.warning,logoutContainer.hide())}})}function popLogin(){$("#login_button").click()}function process_email(){var t=$(this).length>0?$($(this)[0].form):$(),e=$(".mailing_container"),n=$(".select_emails_container").find(".select_emails_list");if(n.find(".mailing_recipients_empty").remove(),!$.trim(n.html()).length)return n.html('<p class="mailing_recipients_empty sys_msg warning leanmodal" id="warning">You must select recipients before sending your email!</p>'),!0;if(!checkform(t))return!1;var o=function(){var n=t.serializeArray(),o=tinyMCE.get("spec_msg").getContent(),a=[];t.find("input.upl_link").each(function(){a.push($(this).val())}),a=a.join(","),n=modArray(n,"body",o),n=modArray(n,"attachments",a),processAjax(e,n,null,"php/form.php")};$(".select_emails_selector").val();if("yes"===$("#make_news").val()){trigger_modal($(this));var a='The option "Add as news" is set to "Yes", which means the content of your email will be published as a news. Do you want to continue?';confirmation_box($(this),a,"Continue",o)}else o(),close_modal();return!0}function show_submission_details(t){void 0!==t.destination?$(t.destination):modalpubform;t.show_submission_details=!0,jQuery.ajax({url:"php/form.php",type:"POST",async:!1,data:t,success:function(t){var e=jQuery.parseJSON(t);load_section(e)}})}function realWidth(t){var e=t.clone();e.css("visibility","hidden"),$("body").append(e);var n=e.outerWidth();return e.remove(),n}function clear_active_submenu(){$(".submenu").is(":visible")&&$(".submenu").hide(),$(".submenu_trigger").each(function(){$(this).parent("li").removeClass("active_submenu")})}function show_submenu(t){var e=t.parent("li");if(e.hasClass("active_submenu"))return!0;clear_active_submenu(),e.addClass("active_submenu");var n,o=e.position(),a=e.outerHeight(),i=t.attr("id");t.closest("div").hasClass("sideMenu")?(n=$(".sideMenu nav.submenu#"+i),n.toggle(200)):(n=$(".topnav nav.submenu#"+i),n.css({left:o.left+"px",top:o.top+a+"px"}).toggle(200))}function process_vote(t){if(null===login_start)return popLogin(),!1;var e=t.parent(".vote_container"),n=e.data();n.process_vote=!0,jQuery.ajax({url:"php/form.php",data:n,type:"post",async:!0,success:function(n){var o=jQuery.parseJSON(n);o.status!==!1&&(o.state?(t.toggleClass("vote_default vote_liked"),e.data("operation","delete"),e.attr("data-operation","delete")):(t.toggleClass("vote_liked vote_default"),e.data("operation","add"),e.attr("data-operation","add")),t.next().html(o.count))}})}function process_bookmark(t){var e=t.data();e.process_vote=!0,jQuery.ajax({url:"php/form.php",data:e,type:"post",async:!0,success:function(e){var n=jQuery.parseJSON(e);n.status===!0&&(n.state?(t.toggleClass("bookmark_off bookmark_on"),t.attr("data-operation","delete"),t.data("operation","delete")):(t.toggleClass("bookmark_on bookmark_off"),t.attr("data-operation","add"),t.data("operation","add")))}})}function process_post(t,e){e.preventDefault();var n=t.length>0?$(t[0].form):$();if(!checkform(n))return!1;var o=n.find(".upl_link");if(o[0]){var a=[];o.each(function(){var t=$(this).val();a.push(t)}),a=a.join(","),n.append("<input type='hidden' name='link' value='"+a+"'>")}var i=getData(n),s=n.find('input[name="controller"]').val(),r=function(t){if(t.status!==!0)return!1;var e=s.toLowerCase()+"_form";$("section#"+e+", .modal_section#"+e).empty();var o=n.find('input[name="id"]').val().length>0&&n.find('input[name="id"]').length>0?n.find('input[name="id"]').val():void 0,a=void 0!==o?"edit":"new";get_submission_form({controller:s,action:"get_form",operation:a,id:o,destination:"#"+s.toLowerCase()+"_container"})},l=n.find(".wygiwgm");is_editor_active(l)&&tinyMCE.get(l.attr("id")).getContent().length>0&&l.each(function(){var t=tinyMCE.get($(this).attr("id")).getContent();i=modArray(i,$(this).attr("name"),t)}),processAjax(t.closest(".form_container"),i,r,"php/form.php"),e.stopImmediatePropagation()}function process_submission(t,e){e.preventDefault();var n=t.length>0?$(t[0].form):$();if(!checkform(n))return!1;var o=(n.find("select[name='type']").val(),n.find("input[type=date]"));if(void 0!==o&&o.length>0){var a=o.val();if(void 0===a||0===a.length)return showfeedback('<p id="warning">You must choose a date!</p>'),o.focus(),!1}var i=n.find(".upl_link");if(i[0]){var s=[];i.each(function(){var t=$(this).val();s.push(t)}),s=s.join(","),n.append("<input type='hidden' name='media' value='"+s+"'>")}var r=getData(n),l=n.find('input[name="controller"]').val(),c=function(e){if(e.status!==!0)return!1;var o=l.toLowerCase()+"_form";$("section#"+o+", .modal_section#"+o).empty();var a=n.find('input[name="id"]').val().length>0&&n.find('input[name="id"]').length>0?n.find('input[name="id"]').val():void 0,i=void 0!==a?"edit":"new";in_modal(t)?(t.find(".modalContainer").modalWindow("close"),location.reload()):get_submission_form({controller:l,action:"get_form",operation:i,id:a,destination:"#"+l.toLowerCase()+"_container"})};processAjax(t.closest(".form_container"),r,c,"php/form.php"),e.stopImmediatePropagation()}var get_submission_form=function(t){void 0===t.id&&(t.id=!1),void 0===t.operation&&(t.operation="new"),void 0===t.date&&(t.date=!1),void 0===t.type&&(t.type=!1),void 0===t.view&&(t.view="body"),t.loadContent=!0;var e=void 0===t.destination?$(".submission_container"):$(t.destination),n=function(t){e.html(t).fadeIn(200).find("textarea").html(t.content),loadWYSIWYGEditor(),loadCalendarSubmission()};processAjax(e,t,n,"php/form.php")},showpostform=function(t){var e=$(".post_edit_container"),n={post_show:!0,postid:t},o=function(t){var n="<textarea name='content' id='post_edit_container' class='wygiwgm'>"+t.content+"</textarea>";e.empty().html(t.content).fadeIn(200),$(".post_txtarea").html(n).show(),loadWYSIWYGEditor()};processAjax(e,n,o,"php/router.php?controller=Posts&action=editor")},selected=(new Date).getTime(),inititdatepicker=function(t){$(".datepicker").each(function(){var e=void 0!==$(this).data("view")&&"edit"===$(this).data("view");$(this).datepicker({defaultDate:selected,firstDay:1,dateFormat:"yy-mm-dd",inline:!0,showOtherMonths:!0,beforeShowDay:function(n){return renderCalendarCallback(n,t,e)}})})},init_submission_calendar=function(t){$(".datepicker_submission").each(function(){var e=void 0!==$(this).data("view")&&"edit"===$(this).data("view");$(this).datepicker({defaultDate:selected,firstDay:1,dateFormat:"yy-mm-dd",inline:!0,showOtherMonths:!0,beforeShowDay:function(n){return renderCalendarCallback(n,t,e)},onSelect:function(t,e){refresh_date(e,planned_sessions[t])}})})},initAvailabilityCalendar=function(t){var e=$("#availability_calendar");e.datepicker({defaultDate:selected,onSelect:function(t,e){selected=$(this).datepicker("getDate").getTime(),jQuery.ajax({url:"php/form.php",type:"post",async:!0,data:{update_user_availability:!0,date:t},success:function(){loadCalendarAvailability()}})},firstDay:1,dateFormat:"yy-mm-dd",inline:!0,showOtherMonths:!0,beforeShowDay:function(e){return renderCalendarCallback(e,t)}})},planned_sessions={},logoutTemplate="<div class='logoutWarning'><div class='logout_msg'></div><div class='logout_button'>OK</div></div>",logout=function(){0===logoutContainer.length&&$("body").append(logoutTemplate),login_start=null,login_expire=null,jQuery.ajax({url:"php/form.php",type:"POST",data:{logout:!0},async:!0,success:function(t){var e=jQuery.parseJSON(t);logoutContainer.find(".logout_msg").html("You have been logged out"),logoutContainer.find(".logout_button").html("OK"),logoutContainer.fadeIn(200),setTimeout(function(){logoutContainer.fadeOut(200).empty().hide(),window.location=e},3e3)}})},login_start=null,login_expire=null,login_warning=null,logoutContainer=$(".logoutWarning"),modalpubform=$(".modal_section#submission_form");$(document).ready(function(){var t;setInterval(check_login,5e3),$(document).on("click","#float_menu",function(){var t=$(this).position(),e=$(this).outerHeight(),n=$(window).height();$(".sideMenu").css({top:e+"px",left:t.left+"px",height:n-e+"px","max-height":n-e+"px"}).animate({width:"toggle"})}).on("mouseover",".submenu_trigger",function(t){t.preventDefault(),show_submenu($(this))}).on("click",".menu-section",function(t){t.preventDefault(),t.stopPropagation();var e=$(this).find("a");if($(".menu-section").each(function(){$(this).removeClass("activepage")}),$(this).addClass("activepage"),e.is("[id]")){var n=e.attr("href"),o=n.split("&"),a=o[0].split("="),i=a[1],s=!!e.is("[data-param]")&&e.attr("data-param");getPage(i,s),$(".submenu, .dropdown").hide()}var r=$(".sideMenu");r.is(":visible")&&r.animate({width:"toggle"})}).click(function(t){var e=$("nav"),n=$(".sideMenu"),o=$("#float_menu");o.is(t.target)||0!==o.has(t.target).length||(e.is(t.target)||0!==e.has(t.target).length||($(".submenu").hide(),clear_active_submenu()),n.is(":visible")&&!n.is(t.target)&&0===n.has(t.target).length&&n.animate({width:"toggle"}))}).on("mouseenter","#core, .submission",function(t){t.preventDefault()}).on("change","#availability_calendar",function(){alert($(this).val())}).on("click",".change_pwd",function(t){t.preventDefault();var e=$(this).closest("form"),n=$(this).attr("id"),o={request_password_change:!0,email:n},a=function(t){var e=jQuery.parseJSON(t);trigger_modal($(this),!1),dialog_box($(this),e,"Modify event")};processAjax(e,o,a,"php/form.php")}).on("click",".conf_changepw",function(t){t.preventDefault();var e=$(this),n=e.length>0?$(e[0].form):$();if(!checkform(n))return!1;var o=n.serialize(),a=function(t){t.status===!0&&setTimeout(logout,2e3)};processAjax(n,o,a,"php/form.php")}).on("click",".user_select",function(t){t.preventDefault();var e=$(this).data("filter");return jQuery.ajax({url:"php/form.php",type:"POST",async:!0,data:{user_select:e},success:function(t){var e=jQuery.parseJSON(t);$("#user_list").html(e)}}),!1}).on("change",".modify_status",function(t){t.preventDefault();var e=$("#user_list"),n=$(this).attr("data-user"),o=$(this).val(),a={modify_status:!0,username:n,option:o},i=function(t){setTimeout(function(){$("#user_list").html(t.content)},2e3)};processAjax(e,a,i,"php/form.php")}).on("change",".account_action",function(t){t.preventDefault();var e=$("#user_list"),n=$(this).attr("data-user"),o=$(this).val(),a={username:n},i=function(t){setTimeout(function(){$("#user_list").html(t.content)},2e3)};processAjax(e,a,i,"php/router.php?controller=Users&action="+o)}).on("click",".test_email_settings",function(t){t.preventDefault(),testEmailSettings($(this))}).on("change",".select_emails_selector",function(t){t.preventDefault(),addRecipients($(this))}).on("click",".added_email_delete",function(t){var e=$(this).closest("form"),n=$(this).attr("id"),o=$(".added_email#"+n),a=e.find("input[name='emails']"),i=a.val().split(","),s=i.indexOf(n);s>-1&&i.splice(s,1),a.val(i.join(",")),o.remove()}).on("click",".mailing_send",function(t){t.preventDefault(),sendToRecipients($(this))}).on("change",".select_post",function(t){t.preventDefault();var e=$(this).val();showpostform(e)}).on("click",".edit_post",function(t){t.preventDefault();var e=$(this).closest(".news-details").attr("id");showpostform(e)}).on("click",".post_new",function(t){t.preventDefault(),showpostform(!1)}).on("click",".post_del",function(t){t.preventDefault();var e=$(this).attr("data-id"),n={post_del:!0,postid:e},o=function(t){t.status===!0&&showpostform(!1)};processAjax($(".postcontent"),n,o,"php/form.php")}).on("click",".process_post",function(t){process_post($(this),t)}).on("click",".show_log",function(t){t.preventDefault();var e=$(this);loadContent(e,function(t){$(".log_list_item_container").each(function(){$(this).removeClass("log_list_active")});var n=(e.closest(".log_container").attr("id"),e.closest(".log_list_item_container"));n.addClass("log_list_active")})}).on("click",".search_log",function(t){t.preventDefault();var e=$(this),n=e.length>0?$(e[0].form):$();e.data({url:n.attr("action")+n.find("input[name='search']").val(),destination:".log_content_container#"+$(this).attr("id")}),loadContent(e)}).on("click",".type_add",function(t){t.preventDefault();var e=$(this).attr("data-class"),n=$("input#new_"+e+"_type").val();if($(this).hasClass("wrongField")&&$(this).removeClass("wrongField"),0===n.length)return $(this).siblings("input").addClass("wrongField"),!0;var o=$(this);jQuery.ajax({url:"php/form.php",type:"POST",async:!0,data:{add_type:e,typename:n},beforeSend:function(){o.toggleClass("addBtn loadBtn")},complete:function(){o.toggleClass("addBtn loadBtn")},success:function(t){var n=jQuery.parseJSON(t);n!==!1?($(".type_list#"+e).html(n),$("input#new_"+e+"_type").empty()):showfeedback("<span class='sys_msg warning'>We could not add this new category","feedback_"+e)}})}).on("click",".type_del",function(t){t.preventDefault();var e=$(this).attr("data-type"),n=$(this).attr("data-class"),o=$(this);jQuery.ajax({url:"php/form.php",type:"POST",async:!0,data:{del_type:n,typename:e},beforeSend:function(){o.addClass("loadBtn")},complete:function(){o.removeClass("loadBtn")},success:function(t){var e=jQuery.parseJSON(t);e.status!==!1?$(".type_list#"+n).html(e):validsubmitform($(".type_list#"+n),t)}})}).on("change",".type_default",function(t){t.preventDefault();var e=$(this).attr("id"),n=$("#"+e+"_types_options"),o=$(this).val(),a={type_default:o,class_name:e};processAjax(n,a,!1,"php/form.php")}).on("change",".repeated_session",function(t){var e=$(this).val(),n=$(this).length>0?$($(this)[0].form):$(),o=n.find(".settings_hidden");1==e?o.each(function(){$(this).fadeIn()}):o.each(function(){$(this).fadeOut()})}).on("change",".selectSession",function(t){t.preventDefault();var e=$(this).val(),n=$(this).attr("data-status").length?$(this).data("status"):"admin",o=void 0===$(this).data("view")?"simple":$(this).data("view"),a={show_session:e,status:n,view:o},i=$("#sessionlist"),s=function(t){$("#sessionlist").html(t).fadeIn(200)};processAjax(i,a,s,"php/form.php")}).on("focus",".modSpeaker",function(){t=$(this).val()}).on("change",".modSpeaker",function(){var e=$(this).val(),n=$(this).closest(".pres_container"),o=n.attr("id"),a=$(this).closest(".session_div").data("id"),i={modSpeaker:e,previous:t,presid:o,session_id:a};processAjax($(this).closest(".session_div"),i,null,"php/form.php")}).on("submit","form",function(t){checkform($(this))||t.stopPropagation()}).on("click",".modify_session",function(t){t.preventDefault();var e=$(this),n=e.length>0?$(e[0].form):$(),o=n.find('input[name="id"]').val(),a=n.attr("action"),i=function(t){0===n.find('input[name="operation"]').length?n.append("<input type='hidden' name='operation' value='"+t+"' />"):n.find('input[name="operation"]').attr("value",t);var o=getData(n);processAjax(n,o,function(){e.modalTrigger("close")},a)};jQuery.ajax({url:"php/router.php?controller=Session&action=is_recurrent",type:"post",data:{id:o},async:!0,success:function(t){if(jQuery.parseJSON(t)===!0){trigger_modal(e,!1);var n="<p>This event is recurrent</p>. <input type='submit' value='Modify this occurrence only' class='callback_trigger' data-operation='present'/><input type='submit' value='Modify all future occurrences' class='callback_trigger' data-operation='future'/><input type='submit' value='Modify all occurrences' class='callback_trigger' data-operation='all'/>";dialog_box(e,n,"Modify event",function(t){i(t.data("operation"))})}else i("present")}})}).on("click",".delete_session",function(t){t.preventDefault();var e=$(this).length>0?$($(this)[0].form):$(),n=e.find('input[name="id"]').val(),o=$(this),a=function(t){0===e.find('input[name="operation"]').length?e.append("<input type='hidden' name='operation' value='"+t+"' />"):e.find('input[name="operation"]').attr("value",t);var n=e.serializeArray();n.push({name:"delSession",value:!0}),processAjax(e,n,close_modal,"php/form.php")};jQuery.ajax({url:"php/form.php",type:"post",data:{is_recurrent:n},async:!0,success:function(t){if(jQuery.parseJSON(t)===!0){trigger_modal(o,!1);var e="<p>This event is recurrent</p>. <input type='submit' value='Delete this occurrence only' class='callback_trigger' data-operation='present'/><input type='submit' value='Delete all future occurrences' class='callback_trigger' data-operation='future'/><input type='submit' value='Delete all occurrences' class='callback_trigger' data-operation='all'/>";dialog_box(o,e,"Delete event",function(t){a(t.data("operation"))})}else confirmation_box(o,"Are you sure you want to delete this session?","Delete",function(){a("present")})}})}).on("change",".mod_session_type",function(t){t.preventDefault();var e=$(this).attr("name"),n=$(this).val(),o=$(this).closest(".session_div"),a=o.data("id"),i={mod_session_type:!0,session:a,prop:e,value:n};processAjax(o,i,null,"php/form.php")}).on("change",".archive_select",function(t){t.preventDefault();var e=$(this).val(),n={select_year:e},o=function(t){$("#archives_list").html(t)},a=$("#archives_list");processAjax(a,n,o,"php/form.php")}).on("change","#select_wish",function(t){t.preventDefault(),$(this).data("id",$(this).val()),loadContent($(this))}).on("click",".loadContent",function(t){t.preventDefault(),loadContent($(this))}).on("click",".select_suggestion",function(t){t.preventDefault(),get_submission_form($(this).data())}).on("click",".dl_btn",function(){$(".dlmenu").toggle()}).on("click",".link_name",function(){var t=$(this).attr("id"),e="uploads/"+t;window.open(e,"_blank")}).on("change",".change_pres_type",function(t){t.preventDefault();var e=($(this).length>0?$($(this)[0].form):$(),$(this).val()),n=$(this).attr("id").split("_"),o=n[0],a=n[1],i=function(t){$(".special_inputs_container").html(t)},s={getFormContent:e,controller:o,id:a};processAjax($(".special_inputs_container"),s,i,"php/form.php")}).on("click",".submit_pres",function(t){process_submission($(this),t)}).on("click",".vote_icon",function(){process_vote($(this))}).on("click",".bookmark_container",function(){process_bookmark($(this))}).on("click","#logout",function(t){t.preventDefault(),logout()}).on("click",".logout_button",function(){$(".logoutWarning").fadeOut(200).toggle()}).on("click",".extend_session",function(){extend_session()}).on("click",".get_suggestion_list",function(t){var e={get_suggestion_list:!0},n=function(t){modalpubform.html(t).fadeIn(200)};processAjax(modalpubform,e,n,"php/form.php")}).on("click",".load_content",function(t){t.preventDefault();for(var e=$(this).attr("href"),n=e.split("?"),o=n[1].split("&"),a={},i=0;i<o.length;i++){var s=o[i].split("=");a[s[0]]=s[1]}var r=void 0!==a.op&&a.op;if("wishpick"===r){var l={get_suggestion_list:!0},c=function(t){el.html(t).fadeIn(200)};processAjax(el,l,c,"php/form.php")}else get_submission_form($(this).data())}).on("mouseover",".leanModal",function(t){t.preventDefault();var e=function(){loadWYSIWYGEditor(),loadCalendarSubmission()};trigger_modal($(this),!0,e)}).on("click",".go_to_section",function(t){t.preventDefault(),$(this).closest(".modalContainer").modalWindow("go_to_section",$(this).data())}).on("click",".modal_trigger_changepw",function(t){t.preventDefault(),$(this).modalTrigger("show_section","user_changepw")}).on("click",".back_btn",function(t){return t.preventDefault(),$(this).closest(".modalContainer").modalWindow("go_to_previous",$(this).data("prev")),!1}).on("click",".show_section",function(t){t.preventDefault(),$(this).modalTrigger("load_section",$(this).data())}).on("click",".delete",function(t){t.preventDefault();var e=$(this),n=void 0!==e.data("action")?e.data("action"):"delete",o=void 0!==e.data("controller")?"php/router.php?controller="+e.data("controller")+"&action="+n:e.attr("href");confirmation_box(e,"Are you sure you want to delete this item?","Delete",function(){jQuery.ajax({url:o,type:"post",data:{id:e.data("id")},async:!0,success:function(t){var n=jQuery.parseJSON(t);n===!0||n.hasOwnProperty("status")&&n.status===!0?(showfeedback("<div class='sys_msg success'>Item deleted</div>",".confirmation_text"),setTimeout(function(){e.modalTrigger("close"),location.reload()},2e3)):showfeedback("<div class='sys_msg warning'>Item could not be deleted</div>",".confirmation_text",!1)}})})}).on("click",".user_delete",function(t){t.preventDefault();var e=$(this);e.data("action","delete"),jQuery.ajax({url:"php/form.php",type:"post",data:{get_delete_account_form:!0},success:function(t){var n=jQuery.parseJSON(t);confirmation_box(e,n.content,null,function(){var t=e.data();t.delete=!0,jQuery.ajax({url:"php/form.php",type:"post",data:t,success:function(t){var e=jQuery.parseJSON(t);e===!0?(showfeedback("<div class='sys_msg success'>Account successfully deleted. You are going to be logged out.</div>",".confirmation_text"),setTimeout(function(){close_modal(),location.reload()},2e3)):showfeedback("<div class='sys_msg warning'>Sorry, we could not delete your account. Please, try later.</div>",".confirmation_text",!1)}})})}})}).on("click",".confirmdeleteuser",function(t){t.preventDefault();var e=$(this),n=e.length>0?$(e[0].form):$(),o=function(t){t.status===!0&&logout()};processForm(n,o),t.stopImmediatePropagation()}).on("click"," .login",function(t){t.preventDefault();var e=$(this),n=e.length>0?$(e[0].form):$(),o=function(t){t.status===!0&&location.reload()};processForm(n,o,"reload"),t.stopImmediatePropagation()}).on("click",".register",function(t){t.preventDefault();var e=$(this),n=e.length>0?$(e[0].form):$(),o=function(t){t.status===!0&&e.modalTrigger("close")};processForm(n,o),t.stopImmediatePropagation()})});