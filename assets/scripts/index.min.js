var get_submission_form=function(b){if(b.id===undefined){b.id=false}if(b.operation===undefined){b.operation="new"}if(b.date===undefined){b.date=false}if(b.type===undefined){b.type=false}if(b.view===undefined){b.view="body"}b.loadContent=true;var a=(b.destination===undefined)?$(".submission_container"):$(b.destination);var c=function(d){a.html(d).fadeIn(200).find("textarea").html(d.content);loadWYSIWYGEditor();loadCalendarSubmission()};processAjax(a,b,c,"php/form.php")};function loadContent(b){var c=b.data();c.loadContent=true;var a=(c.destination===undefined)?b.closest("section"):$(c.destination);var d=function(e){var f=e.content===undefined?e:e.content;a.html(f).css("visibility","visible").fadeIn(200);loadWYSIWYGEditor();loadCalendarSubmission()};processAjax(a,c,d,"php/form.php")}var showpostform=function(d){var a=$(".post_edit_container");var b={post_show:true,postid:d};var c=function(e){var f="<textarea name='content' id='post_edit_container' class='wygiwgm'>"+e.content+"</textarea>";a.empty().html(e.content).fadeIn(200);$(".post_txtarea").html(f).show();loadWYSIWYGEditor()};processAjax(a,b,c,"php/router.php?controller=Posts&action=editor")};function confirmation_box(c,a,d,e){trigger_modal(c,false);var b=$(".modalContainer");if(b.find(".modal_section#confirmation_box").length>0){b.find(".modal_section#confirmation_box").remove()}jQuery.ajax({type:"post",url:"php/form.php",data:{get_box:true,action:"confirmation",button_txt:d,text:a},async:true,success:function(g){var f=jQuery.parseJSON(g);b.find(".popupBody").append(f);c.modalTrigger("showOverlay");var h=c.modalTrigger("getWindow");h.modalWindow("show_section","confirmation_box");var i=$(".modal_section#confirmation_box");i.find("input[name='confirmation']").click(function(){e()});i.find("input[name='cancel']").click(function(){h.modalWindow("close")})}})}function dialog_box(c,a,d,e){trigger_modal(c,false);if(d===undefined){d=""}var b=$(".modalContainer");if(b.find(".modal_section#confirmation_box").length>0){b.find(".modal_section#confirmation_box").remove()}jQuery.ajax({type:"post",url:"php/form.php",data:{get_box:true,action:"dialog",text:a,title:d},async:true,success:function(g){var f=jQuery.parseJSON(g);b.find(".popupBody").append(f);c.modalTrigger("showOverlay");var h=c.modalTrigger("getWindow");h.modalWindow("show_section","confirmation_box");var i=$(".modal_section#confirmation_box");i.find(".callback_trigger").click(function(){e($(this))});i.find("input[name='cancel']").click(function(){h.modalWindow("close")})}})}var selected=new Date().getTime();function removeDatePicker(){jQuery("#ui-datepicker-div").remove()}var inititdatepicker=function(a){$(".datepicker").each(function(){var b=$(this).data("view")!==undefined?$(this).data("view")==="edit":false;$(this).datepicker({defaultDate:selected,firstDay:1,dateFormat:"yy-mm-dd",inline:true,showOtherMonths:true,beforeShowDay:function(c){return renderCalendarCallback(c,a,b)}})})};var init_submission_calendar=function(a){$(".datepicker_submission").each(function(){var b=$(this).data("view")!==undefined?$(this).data("view")==="edit":false;$(this).datepicker({defaultDate:selected,firstDay:1,dateFormat:"yy-mm-dd",inline:true,showOtherMonths:true,beforeShowDay:function(c){return renderCalendarCallback(c,a,b)},onSelect:function(d,c){refresh_date(c,planned_sessions[d])}})})};var initAvailabilityCalendar=function(a){var b=$("#availability_calendar");b.datepicker({defaultDate:selected,onSelect:function(d,c){selected=$(this).datepicker("getDate").getTime();jQuery.ajax({url:"php/form.php",type:"post",async:true,data:{update_user_availability:true,date:d},success:function(){loadCalendarAvailability()}})},firstDay:1,dateFormat:"yy-mm-dd",inline:true,showOtherMonths:true,beforeShowDay:function(c){return renderCalendarCallback(c,a)}})};var planned_sessions={};function renderCalendarCallback(d,f,a){var k=d.getDay();var j=$.datepicker.formatDate("dd-mm-yy",d);var c=$.inArray(j,f.booked);var g=null;var m=null;var h=a;if(c>-1){g=[];planned_sessions[$.datepicker.formatDate("yy-mm-dd",d)]=f.session_id[c];var l=f.slots[c]-f.nb[c];var i=f.renderTypes[c];m=i+": ("+l+" slot(s) available)";h=l>0||a;if(f.nb[c]===0){g.push("jc_day")}else{if(f.nb[c]<f.slots[c]){g.push("jc_day jc_day_rem")}else{g.push("jc_day full_day");m=i+": Booked out"}}var b=$.inArray(j,f.Availability);if(b>-1){g.push("not_available");m="You are not available this day"}var e=$.inArray(j,f.Assignments);if(e>-1){g.push("assigned");m="You are presenting this day"}g=g.join(" ");return[h,g,m]}else{return[h,"","No session planned on this day"]}}function refresh_date(c,b){var d=$(c.input[0].form);var a=d.find('input[name="session_id"]');if(a!==undefined&&a.length>0){a.val(b)}else{d.append("<input type='hidden' name='session_id' value='"+b+"' />")}}var logoutTemplate="<div class='logoutWarning'><div class='logout_msg'></div><div class='logout_button'>OK</div></div>";var logout=function(){if(logoutContainer.length===0){$("body").append(logoutTemplate)}login_start=null;login_expire=null;jQuery.ajax({url:"php/form.php",type:"POST",data:{logout:true},async:true,success:function(b){var a=jQuery.parseJSON(b);logoutContainer.find(".logout_msg").html("You have been logged out");logoutContainer.find(".logout_button").html("OK");logoutContainer.fadeIn(200);setTimeout(function(){logoutContainer.fadeOut(200).empty().hide();window.location=a},3000)}})};var login_start=null,login_expire=null,login_warning=null;var logoutContainer=$(".logoutWarning");function check_login(){if(logoutContainer.length===0){$("body").append(logoutTemplate);logoutContainer=$(".logoutWarning")}if(login_start===null){jQuery.ajax({url:"php/form.php",data:{check_login:true},type:"post",async:true,success:function(h){var d=jQuery.parseJSON(h);if(d!==false){login_start=d.start;login_expire=d.expire;login_warning=d.warning}}})}else{var f=Math.floor(new Date().getTime()/1000);var c=login_expire-f;if(c<=login_warning&&c>0){var b=1000*Math.round(c);var g=new Date(b);var e=(g.getUTCMinutes()<10)?"0"+g.getUTCMinutes():g.getUTCMinutes();var a=(g.getUTCSeconds()<10)?"0"+g.getUTCSeconds():g.getUTCSeconds();logoutContainer.find(".logout_msg").html("You will be automatically logged out in "+e+":"+a+" due to inactivity");logoutContainer.find(".logout_button").addClass("extend_session").html("Extend");if(!logoutContainer.is(":visible")){logoutContainer.fadeIn(200)}}else{if(c<0){logout()}}}}function extend_session(){jQuery.ajax({url:"php/router.php?controller=Auth&action=extend_login",type:"post",async:true,success:function(b){var a=jQuery.parseJSON(b);if(a!==false){login_start=a.start;login_expire=a.expire;login_warning=a.warning;logoutContainer.hide()}}})}function popLogin(){$("#login_button").click()}function process_email(){var b=$(this).length>0?$($(this)[0].form):$();var a=$(".mailing_container");var f=$(".select_emails_container").find(".select_emails_list");f.find(".mailing_recipients_empty").remove();if(!$.trim(f.html()).length){f.html('<p class="mailing_recipients_empty sys_msg warning leanmodal" id="warning">You must select recipients before sending your email!</p>');return true}if(!checkform(b)){return false}var e=function(){var i=b.serializeArray();var h=tinyMCE.get("spec_msg").getContent();var g=[];b.find("input.upl_link").each(function(){g.push($(this).val())});g=g.join(",");i=modArray(i,"body",h);i=modArray(i,"attachments",g);processAjax(a,i,null,"php/form.php")};var d=$(".select_emails_selector").val();if($("#make_news").val()==="yes"){trigger_modal($(this));var c='The option "Add as news" is set to "Yes", which means the content of your email will be published as a news. Do you want to continue?';confirmation_box($(this),c,"Continue",e)}else{e();close_modal()}return true}var modalpubform=$(".modal_section#submission_form");function show_submission_details(b){var a=b.destination!==undefined?$(b.destination):modalpubform;b.show_submission_details=true;jQuery.ajax({url:"php/form.php",type:"POST",async:false,data:b,success:function(d){var c=jQuery.parseJSON(d);load_section(c)}})}function realWidth(b){var c=b.clone();c.css("visibility","hidden");$("body").append(c);var a=c.outerWidth();c.remove();return a}function clear_active_submenu(){if($(".submenu").is(":visible")){$(".submenu").hide()}$(".submenu_trigger").each(function(){$(this).parent("li").removeClass("active_submenu")})}function show_submenu(e){var d=e.parent("li");if(d.hasClass("active_submenu")){return true}clear_active_submenu();d.addClass("active_submenu");var b=d.position();var a=d.outerHeight();var f=e.attr("id");var c;if(e.closest("div").hasClass("sideMenu")){c=$(".sideMenu nav.submenu#"+f);c.toggle(200)}else{c=$(".topnav nav.submenu#"+f);c.css({left:b.left+"px",top:b.top+a+"px"}).toggle(200)}}function process_vote(b){if(login_start===null){popLogin();return false}var a=b.parent(".vote_container");var c=a.data();c.process_vote=true;jQuery.ajax({url:"php/form.php",data:c,type:"post",async:true,success:function(e){var d=jQuery.parseJSON(e);if(d.status!==false){if(!d.state){b.toggleClass("vote_liked vote_default");a.data("operation","add");a.attr("data-operation","add")}else{b.toggleClass("vote_default vote_liked");a.data("operation","delete");a.attr("data-operation","delete")}b.next().html(d.count)}}})}function process_bookmark(a){var b=a.data();b.process_vote=true;jQuery.ajax({url:"php/form.php",data:b,type:"post",async:true,success:function(d){var c=jQuery.parseJSON(d);if(c.status===true){if(!c.state){a.toggleClass("bookmark_on bookmark_off");a.attr("data-operation","add");a.data("operation","add")}else{a.toggleClass("bookmark_off bookmark_on");a.attr("data-operation","delete");a.data("operation","delete")}}}})}function process_post(c,h){h.preventDefault();var b=c.length>0?$(c[0].form):$();if(!checkform(b)){return false}var a=b.find(".upl_link");if(a[0]){var j=[];a.each(function(){var e=$(this).val();j.push(e)});j=j.join(",");b.append("<input type='hidden' name='link' value='"+j+"'>")}var d=getData(b);var f=b.find('input[name="controller"]').val();var i=function(e){if(e.status===true){var m=f.toLowerCase()+"_form";$("section#"+m+", .modal_section#"+m).empty();var l=b.find('input[name="id_pres"]').val().length>0&&b.find('input[name="id_pres"]').length>0?b.find('input[name="id_pres"]').val():undefined;var k=l!==undefined?"edit":"new";get_submission_form({controller:f,action:"get_form",operation:k,id:l,destination:"#"+f.toLowerCase()+"_container"})}else{return false}};var g=b.find(".wygiwgm");if(is_editor_active(g)&&tinyMCE.get(g.attr("id")).getContent().length>0){g.each(function(){var e=tinyMCE.get($(this).attr("id")).getContent();d=modArray(d,$(this).attr("name"),e)})}processAjax(c.closest(".form_container"),d,i,"php/form.php");h.stopImmediatePropagation()}function process_submission(c,h){h.preventDefault();var b=c.length>0?$(c[0].form):$();if(!checkform(b)){return false}var i=b.find("select[name='type']").val();var l=b.find("input[type=date]");if(l!==undefined&&l.length>0){var d=l.val();if(d===undefined||d.length===0){showfeedback('<p id="warning">You must choose a date!</p>');l.focus();return false}}var a=b.find(".upl_link");if(a[0]){var k=[];a.each(function(){var e=$(this).val();k.push(e)});k=k.join(",");b.append("<input type='hidden' name='link' value='"+k+"'>")}var f=getData(b);var g=b.find('input[name="controller"]').val();var j=function(e){if(e.status===true){var o=g.toLowerCase()+"_form";$("section#"+o+", .modal_section#"+o).empty();var n=b.find('input[name="id_pres"]').val().length>0&&b.find('input[name="id_pres"]').length>0?b.find('input[name="id_pres"]').val():undefined;var m=n!==undefined?"edit":"new";if(in_modal(c)){c.find(".modalContainer").modalWindow("close");location.reload()}else{get_submission_form({controller:g,action:"get_form",operation:m,id:n,destination:"#"+g.toLowerCase()+"_container"})}}else{return false}};processAjax(c.closest(".form_container"),f,j,"php/form.php");h.stopImmediatePropagation()}$(document).ready(function(){var a;setInterval(check_login,5000);$(document).on("click","#float_menu",function(){var c=$(this).position();var b=$(this).outerHeight();var d=$(window).height();$(".sideMenu").css({top:b+"px",left:c.left+"px",height:(d-b)+"px","max-height":(d-b)+"px"}).animate({width:"toggle"})}).on("mouseover",".submenu_trigger",function(b){b.preventDefault();show_submenu($(this))}).on("click",".menu-section",function(g){g.preventDefault();g.stopPropagation();var b=$(this).find("a");$(".menu-section").each(function(){$(this).removeClass("activepage")});$(this).addClass("activepage");if(b.is("[id]")){var c=b.attr("href");var f=c.split("&");var j=f[0].split("=");var d=j[1];var i=(b.is("[data-param]"))?b.attr("data-param"):false;getPage(d,i);$(".submenu, .dropdown").hide()}var h=$(".sideMenu");if(h.is(":visible")){h.animate({width:"toggle"})}}).click(function(c){var f=$("nav");var d=$(".sideMenu");var b=$("#float_menu");if(!b.is(c.target)&&b.has(c.target).length===0){if(!f.is(c.target)&&f.has(c.target).length===0){$(".submenu").hide();clear_active_submenu()}if(d.is(":visible")&&!d.is(c.target)&&d.has(c.target).length===0){d.animate({width:"toggle"})}}}).on("mouseenter","#core, .submission",function(b){b.preventDefault()}).on("change","#availability_calendar",function(){alert($(this).val())}).on("click",".change_pwd",function(f){f.preventDefault();var c=$(this).closest("form");var b=$(this).attr("id");var d={request_password_change:true,email:b};var g=function(h){var e=jQuery.parseJSON(h);trigger_modal($(this),false);dialog_box($(this),e,"Modify event")};processAjax(c,d,g,"php/form.php")}).on("click",".conf_changepw",function(f){f.preventDefault();var b=$(this);var c=b.length>0?$(b[0].form):$();if(!checkform(c)){return false}var d=c.serialize();var g=function(e){if(e.status===true){setTimeout(logout,2000)}};processAjax(c,d,g,"php/form.php")}).on("click",".user_select",function(c){c.preventDefault();var b=$(this).data("filter");jQuery.ajax({url:"php/form.php",type:"POST",async:true,data:{user_select:b},success:function(e){var d=jQuery.parseJSON(e);$("#user_list").html(d)}});return false}).on("change",".modify_status",function(d){d.preventDefault();var h=$("#user_list");var g=$(this).attr("data-user");var b=$(this).val();var c={modify_status:true,username:g,option:b};var f=function(e){setTimeout(function(){$("#user_list").html(e.content)},2000)};processAjax(h,c,f,"php/form.php")}).on("change",".account_action",function(d){d.preventDefault();var h=$("#user_list");var g=$(this).attr("data-user");var c=$(this).val();var b={username:g};var f=function(e){setTimeout(function(){$("#user_list").html(e.content)},2000)};processAjax(h,b,f,"php/router.php?controller=Users&action="+c)}).on("click",".test_email_settings",function(f){f.preventDefault();var b=$(this);var c=b.length>0?$(b[0].form):$();var d=c.serializeArray();d.push({name:"test_email_settings",value:true});processAjax(c,d,false,"php/form.php")}).on("click",".add_email",function(g){g.preventDefault();var b=$(".select_emails_selector");var f=b.length>0?$(b[0].form):$();var c=b.find("option:selected").html();var i=b.val();var h=$(".select_emails_container").find(".select_emails_list");$(".select_emails_container").find(".select_emails_list").find(".mailing_recipients_empty").remove();var d=f.find("input[name='emails']");jQuery.ajax({url:"php/form.php",type:"post",data:{add_emails:i},async:true,success:function(j){var e=jQuery.parseJSON(j);if(e.status){if(d!==undefined&&d.length>0){var k=d.val().split(",");k.push(e.ids);k=(k[0]==="")?k.slice(1,k.length):k;d.val(k.join(","))}else{f.append("<input name='emails' type='hidden' value='"+e.ids+"'/>")}h.append(e.content)}}})}).on("change",".select_emails_selector",function(g){g.preventDefault();var b=$(this);var f=b.length>0?$(b[0].form):$();var c=b.find("option:selected").html();var i=b.val();var h=$(".select_emails_container").find(".select_emails_list");$(".select_emails_container").find(".select_emails_list").find(".mailing_recipients_empty").remove();var d=f.find("input[name='emails']");if(i==="all"){$("#make_news").find("option[value='yes']").prop("selected",true)}jQuery.ajax({url:"php/form.php",type:"post",data:{add_emails:i},success:function(j){var e=jQuery.parseJSON(j);if(e.status){if(d!==undefined&&d.length>0){var k=d.val().split(",");k.push(e.ids);k=(k[0]==="")?k.slice(1,k.length):k;d.val(k.join(","))}else{f.append("<input name='emails' type='hidden' value='"+e.ids+"'/>")}h.append(e.content)}}})}).on("click",".added_email_delete",function(f){var d=$(this).closest("form");var i=$(this).attr("id");var h=$(".added_email#"+i);var c=d.find("input[name='emails']");var g=c.val().split(",");var b=g.indexOf(i);if(b>-1){g.splice(b,1)}c.val(g.join(","));h.remove()}).on("click",".mailing_send",function(d){d.preventDefault();var c=$(this).length>0?$($(this)[0].form):$();var b=$(".mailing_container");var i=$(".select_emails_container").find(".select_emails_list");i.find(".mailing_recipients_empty").remove();if(!$.trim(i.html()).length){i.html('<p class="mailing_recipients_empty sys_msg warning leanmodal" id="warning">You must select recipients before sending your email!</p>');return true}if(!checkform(c)){return false}var h=function(){var j=getData(c);var e=[];c.find("input.upl_link").each(function(){e.push($(this).val())});e=e.join(",");j=modArray(j,"attachments",e);processAjax(b,j,false,"php/form.php")};var g=$(".select_emails_selector").val();if($("#make_news").val()==="yes"){trigger_modal($(this));var f='The option "Add as news" is set to "Yes", which means the content of your email will be published as a news. Do you want to continue?';confirmation_box($(this),f,"Continue",h)}else{h()}return true}).on("click",".mail_preview",function(c){c.preventDefault();var b=$(this).attr("id");jQuery.ajax({url:"php/form.php",type:"post",async:true,data:{preview:b},success:function(e){var d=jQuery.parseJSON(e);$(".mail_preview_container").hide().html(d.body).fadeIn(200)}})}).on("change",".select_post",function(b){b.preventDefault();var c=$(this).val();showpostform(c)}).on("click",".edit_post",function(b){b.preventDefault();var c=$(this).closest(".news-details").attr("id");showpostform(c)}).on("click",".post_new",function(b){b.preventDefault();showpostform(false)}).on("click",".post_del",function(c){c.preventDefault();var f=$(this).attr("data-id");var b={post_del:true,postid:f};var d=function(e){if(e.status===true){showpostform(false)}};processAjax($(".postcontent"),b,d,"php/form.php")}).on("click",".process_post",function(b){process_post($(this),b)}).on("click",".show_log",function(f){f.preventDefault();var c=$(this).closest(".log_container").attr("id");var b=$(this).attr("href");var g=$(".log_content_container#"+c);$(".log_list_item_container").each(function(){$(this).removeClass("log_list_active")});var d=$(this).closest(".log_list_item_container");jQuery.ajax({type:"get",url:b,beforeSend:function(){loadingDiv(g)},complete:function(){removeLoading(g)},success:function(h){var e=jQuery.parseJSON(h);g.html(e);d.addClass("log_list_active")}})}).on("click",".search_log",function(g){g.preventDefault();var b=$(this);var f=b.length>0?$(b[0].form):$();var d=$(this).attr("id");var c=f.attr("action");var h=$(".log_content_container#"+d);jQuery.ajax({type:"get",url:c,data:f.serializeArray(),beforeSend:function(){loadingDiv(h)},complete:function(){removeLoading(h)},success:function(i){var e=jQuery.parseJSON(i);h.html(e)}})}).on("click",".delete_log",function(c){c.preventDefault();var d=$(this).closest(".log_container").parent();var b=$(this).attr("href");jQuery.ajax({type:"get",url:b,beforeSend:function(){loadingDiv(d)},complete:function(){removeLoading(d)},success:function(f){var e=jQuery.parseJSON(f);if(e.status===true){d.html(e.content)}}})}).on("click",".show_log_manager",function(d){d.preventDefault();var c=$(this).attr("id");var f=$(".log_target_container#"+c);var b=$(this).attr("href");if(!f.is(":visible")){jQuery.ajax({type:"get",url:b,beforeSend:function(){loadingDiv(f)},complete:function(){removeLoading(f)},success:function(g){var e=jQuery.parseJSON(g);f.html(e).toggle()}})}else{f.toggle()}}).on("click",".type_add",function(f){f.preventDefault();var d=$(this).attr("data-class");var c=$("input#new_"+d+"_type").val();if($(this).hasClass("wrongField")){$(this).removeClass("wrongField")}if(c.length===0){$(this).siblings("input").addClass("wrongField");return true}var b=$(this);jQuery.ajax({url:"php/form.php",type:"POST",async:true,data:{add_type:d,typename:c},beforeSend:function(){b.toggleClass("addBtn loadBtn")},complete:function(){b.toggleClass("addBtn loadBtn")},success:function(g){var e=jQuery.parseJSON(g);if(e!==false){$(".type_list#"+d).html(e);$("input#new_"+d+"_type").empty()}else{showfeedback("<span class='sys_msg warning'>We could not add this new category","feedback_"+d)}}})}).on("click",".type_del",function(f){f.preventDefault();var c=$(this).attr("data-type");var d=$(this).attr("data-class");var b=$(this);jQuery.ajax({url:"php/form.php",type:"POST",async:true,data:{del_type:d,typename:c},beforeSend:function(){b.addClass("loadBtn")},complete:function(){b.removeClass("loadBtn")},success:function(g){var e=jQuery.parseJSON(g);if(e.status!==false){$(".type_list#"+d).html(e)}else{validsubmitform($(".type_list#"+d),g)}}})}).on("change",".type_default",function(f){f.preventDefault();var d=$(this).attr("id");var g=$("#"+d+"_types_options");var b=$(this).val();var c={type_default:b,class_name:d};processAjax(g,c,false,"php/form.php")}).on("change",".repeated_session",function(d){var f=$(this).val();var c=$(this).length>0?$($(this)[0].form):$();var b=c.find(".settings_hidden");if(f==1){b.each(function(){$(this).fadeIn()})}else{b.each(function(){$(this).fadeOut()})}}).on("change",".selectSession",function(g){g.preventDefault();var d=$(this).val();var c=($(this).attr("data-status").length)?$(this).data("status"):"admin";var b=($(this).data("view")===undefined)?"simple":$(this).data("view");var f={show_session:d,status:c,view:b};var i=$("#sessionlist");var h=function(e){$("#sessionlist").html(e).fadeIn(200)};processAjax(i,f,h,"php/form.php")}).on("focus",".modSpeaker",function(){a=$(this).val()}).on("change",".modSpeaker",function(){var c=$(this).val();var b=$(this).closest(".pres_container");var f=b.attr("id");var d=$(this).closest(".session_div").data("id");var e={modSpeaker:c,previous:a,presid:f,session_id:d};processAjax($(this).closest(".session_div"),e,null,"php/form.php")}).on("submit","form",function(b){if(!checkform($(this))){b.stopPropagation()}}).on("click",".modify_session",function(g){g.preventDefault();var d=$(this).length>0?$($(this)[0].form):$();var c=d.find('input[name="id"]').val();var b=$(this);var f=function(e){if(d.find('input[name="operation"]').length===0){d.append("<input type='hidden' name='operation' value='"+e+"' />")}else{d.find('input[name="operation"]').attr("value",e)}var h=d.serializeArray();h.push({name:"modSession",value:true});processAjax(d,h,b.modalTrigger("close"),"php/form.php")};jQuery.ajax({url:"php/form.php",type:"post",data:{is_recurrent:c},async:true,success:function(e){if(jQuery.parseJSON(e)===true){trigger_modal(b,false);var h="<p>This event is recurrent</p>. <input type='submit' value='Modify this occurrence only' class='callback_trigger' data-operation='present'/><input type='submit' value='Modify all future occurrences' class='callback_trigger' data-operation='future'/><input type='submit' value='Modify all occurrences' class='callback_trigger' data-operation='all'/>";dialog_box(b,h,"Modify event",function(i){f(i.data("operation"))})}else{f("present")}}})}).on("click",".delete_session",function(g){g.preventDefault();var d=$(this).length>0?$($(this)[0].form):$();var c=d.find('input[name="id"]').val();var b=$(this);var f=function(e){if(d.find('input[name="operation"]').length===0){d.append("<input type='hidden' name='operation' value='"+e+"' />")}else{d.find('input[name="operation"]').attr("value",e)}var h=d.serializeArray();h.push({name:"delSession",value:true});processAjax(d,h,close_modal,"php/form.php")};jQuery.ajax({url:"php/form.php",type:"post",data:{is_recurrent:c},async:true,success:function(e){if(jQuery.parseJSON(e)===true){trigger_modal(b,false);var h="<p>This event is recurrent</p>. <input type='submit' value='Delete this occurrence only' class='callback_trigger' data-operation='present'/><input type='submit' value='Delete all future occurrences' class='callback_trigger' data-operation='future'/><input type='submit' value='Delete all occurrences' class='callback_trigger' data-operation='all'/>";dialog_box(b,h,"Delete event",function(i){f(i.data("operation"))})}else{confirmation_box(b,"Are you sure you want to delete this session?","Delete",function(){f("present")})}}})}).on("change",".mod_session_type",function(g){g.preventDefault();var h=$(this).attr("name");var d=$(this).val();var b=$(this).closest(".session_div");var f=b.data("id");var c={mod_session_type:true,session:f,prop:h,value:d};processAjax(b,c,null,"php/form.php")}).on("change",".archive_select",function(d){d.preventDefault();var b=$(this).val();var c={select_year:b};var g=function(e){$("#archives_list").html(e)};var f=$("#archives_list");processAjax(f,c,g,"php/form.php")}).on("change","#select_wish",function(b){b.preventDefault();$(this).data("id",$(this).val());loadContent($(this))}).on("click",".loadContent",function(b){b.preventDefault();loadContent($(this))}).on("click",".select_suggestion",function(b){b.preventDefault();get_submission_form($(this).data())}).on("click",".dl_btn",function(){$(".dlmenu").toggle()}).on("click",".link_name",function(){var b=$(this).attr("id");var c="uploads/"+b;window.open(c,"_blank")}).on("change",".change_pres_type",function(h){h.preventDefault();var d=$(this).length>0?$($(this)[0].form):$();var c=$(this).val();var j=$(this).attr("id").split("_");var b=j[0];var g=j[1];var i=function(e){$(".special_inputs_container").html(e)};var f={getFormContent:c,controller:b,id:g};processAjax($(".special_inputs_container"),f,i,"php/form.php")}).on("click",".submit_pres",function(b){process_submission($(this),b)}).on("click",".vote_icon",function(){process_vote($(this))}).on("click",".bookmark_container",function(){process_bookmark($(this))}).on("click","#logout",function(b){b.preventDefault();logout()}).on("click",".logout_button",function(){$(".logoutWarning").fadeOut(200).toggle()}).on("click",".extend_session",function(){extend_session()}).on("click",".get_suggestion_list",function(c){var b={get_suggestion_list:true};var d=function(e){modalpubform.html(e).fadeIn(200)};processAjax(modalpubform,b,d,"php/form.php")}).on("click",".load_content",function(h){h.preventDefault();var l=$(this).attr("href");var j=l.split("?");var b=j[1].split("&");var k={};for(var g=0;g<b.length;g++){var d=b[g].split("=");k[d[0]]=d[1]}var c=(k.op!==undefined)?k.op:false;if(c==="wishpick"){var f={get_suggestion_list:true};var m=function(e){el.html(e).fadeIn(200)};processAjax(el,f,m,"php/form.php")}else{get_submission_form($(this).data())}}).on("mouseover",".leanModal",function(b){b.preventDefault();var c=function(){loadWYSIWYGEditor();loadCalendarSubmission()};trigger_modal($(this),true,c)}).on("click",".go_to_section",function(b){b.preventDefault();$(this).closest(".modalContainer").modalWindow("go_to_section",($(this).data()))}).on("click",".modal_trigger_changepw",function(b){b.preventDefault();$(this).modalTrigger("show_section","user_changepw")}).on("click",".back_btn",function(b){b.preventDefault();$(this).closest(".modalContainer").modalWindow("go_to_previous",($(this).data("prev")));return false}).on("click",".show_section",function(b){b.preventDefault();$(this).modalTrigger("load_section",$(this).data())}).on("click",".delete",function(c){c.preventDefault();var b=$(this);confirmation_box(b,"Are you sure you want to delete this item?","Delete",function(){jQuery.ajax({url:"php/form.php",type:"post",data:{controller:b.data("controller"),action:"delete",id:b.data("id"),"delete":true},async:true,success:function(e){var d=jQuery.parseJSON(e);if(d===true||(d.hasOwnProperty("status")&&d.status===true)){showfeedback("<div class='sys_msg success'>Item deleted</div>",".confirmation_text");setTimeout(function(){b.modalTrigger("close");location.reload()},2000)}else{showfeedback("<div class='sys_msg warning'>Item could not be deleted</div>",".confirmation_text",false)}}})})}).on("click",".user_delete",function(c){c.preventDefault();var b=$(this);b.data("action","delete");jQuery.ajax({url:"php/form.php",type:"post",data:{get_delete_account_form:true},success:function(e){var d=jQuery.parseJSON(e);confirmation_box(b,d.content,null,function(){var f=b.data();f["delete"]=true;jQuery.ajax({url:"php/form.php",type:"post",data:f,success:function(h){var g=jQuery.parseJSON(h);if(g===true){showfeedback("<div class='sys_msg success'>Account successfully deleted. You are going to be logged out.</div>",".confirmation_text");setTimeout(function(){close_modal();location.reload()},2000)}else{showfeedback("<div class='sys_msg warning'>Sorry, we could not delete your account. Please, try later.</div>",".confirmation_text",false)}}})})}})}).on("click",".confirmdeleteuser",function(d){d.preventDefault();var b=$(this);var c=b.length>0?$(b[0].form):$();var f=function(e){if(e.status===true){logout()}};processForm(c,f);d.stopImmediatePropagation()}).on("click"," .login",function(d){d.preventDefault();var b=$(this);var c=b.length>0?$(b[0].form):$();var f=function(e){if(e.status===true){location.reload()}};processForm(c,f,"reload");d.stopImmediatePropagation()}).on("click",".register",function(d){d.preventDefault();var b=$(this);var c=b.length>0?$(b[0].form):$();var f=function(e){if(e.status===true){b.modalTrigger("close")}};processForm(c,f);d.stopImmediatePropagation()})});