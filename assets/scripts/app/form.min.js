function getData(e){var t=e.serializeArray(),i=e.find(".tinymce");return i.length>0&&void 0!==i&&i.each(function(){var e=$(this).attr("id"),i=$(this).attr("name"),n=tinyMCE.get(e).getContent();t=modArray(t,i,n)}),e.find("textarea.wygiwym").each(function(){if(CKEDITOR.instances[$(this).attr("id")]){var e=CKEDITOR.instances[$(this).attr("id")].getData(),i=$(this).attr("name");t=modArray(t,i,e)}}),t}function loadingButton(e){e.addClass("processform_working")}function resetButton(e){setTimeout(function(){e.removeClass("processform_success processform_working processform_failure")},1e3)}function removeLoadingButton(e){e.removeClass("processform_working processform_success processform_failure")}function processAjax(e,t,i,n,a){var s=e.find('input[type="submit"], .processform');jQuery.ajax({url:n,type:"POST",async:!0,data:t,beforeSend:function(){s.length>0?loadingButton(s):loadingDiv(e)},complete:function(){s.length>0?removeLoadingButton(s):removeLoading(e)},success:function(t){i=void 0!==i&&i,validsubmitform(e,jQuery.parseJSON(t),i,a,s)},error:function(){s.length>0?removeLoadingButton(s):removeLoading(e)}})}function format_msg(e,t){var i=!1;return e===!0?i=void 0===t?"<p class='sys_msg success'>DONE!</p>":"<p class='sys_msg success'>"+t+"</p>":void 0!==e&&(i=void 0===t?"<p class='sys_msg warning'>Oops, something has gone wrong!</p>":"<p class='sys_msg warning'>"+t+"</p>"),i}function removeFeedBack(e){fade_inputs(e,!1),e.find(".feedbackForm").fadeIn(500).delay(200,function(){$(this).remove()})}function fade_inputs(e,t){t===!0?e.children("input, select, .form-group").each(function(){$(this).animate({opacity:.2})}):e.children("input, select, .form-group").each(function(){$(this).animate({opacity:1},200)})}function showFeedBack(e,t,i){var n=e.width(),a=e.height(),s=format_msg(t,i);e.hasClass("feedbackFormTarget")||e.addClass("feedbackFormTarget"),void 0===e.attr("id")&&e.attr("id","fb_"+Math.round((new Date).getTime()+100*Math.random())),e.append("<div class='feedbackForm' id='"+e.attr("id")+"'></div>");var o=$(".feedbackForm");fade_inputs(e,!0),o.css({left:0,width:n+"px",height:a+"px"}).html(s);var r=o.find(".sys_msg");r.empty().css({left:0,display:"none",width:.8*n+"px"}).html(i).fadeIn(300)}function modArray(e,t,i){var n;for(n=0;n<e.length;++n)if(e[n].name===t)return e[n].value=i,e;var a={};return a[t]=i,e.push(a),e}var processForm=function(e,t,i,n){if(!checkform(e))return!1;var a=getData(e);i=e.attr("action"),processAjax(e,a,t,i,n)},validsubmitform=function(e,t,i,n,a){e=void 0===e?$("body"):e,i=void 0!==i&&i,n=void 0===n?2e3:n,void 0!==a&&a.length>0&&(removeLoadingButton(a),"boolean"==typeof t&&t===!0||t.status===!0?a.addClass("processform_success"):a.addClass("processform_failure")),void 0!==t.msg?(showFeedBack(e,t.status,t.msg),void 0!==a&&a.length>0&&resetButton(a),t.status===!0&&setTimeout(function(){removeFeedBack(e),i!==!1&&i(t)},n)):(void 0!==a&&a.length>0&&resetButton(a),removeLoading(e),i!==!1&&i(t))},is_editor_active=function(e,t){var i;return"undefined"!=typeof tinyMCE&&(i="undefined"==typeof t?tinyMCE.activeEditor:tinyMCE.EditorManager.get(t),!(null===i||void 0===e||!e.hasClass("tinymce")||null===tinyMCE.get(e.attr("id")))&&!i.isHidden())},checkform=function(e,t){t=void 0===t?e.find("input[type=submit]:focus"):t;var i=!0;e.closest(".inputFeedback").remove();var n="* Required";e.find("input,select,textarea").not('input[type="submit"]').each(function(){$(this).removeClass("wrongField");var e=!0;$(this).is(":visible")&&$(this).prop("required")&&0===$.trim($(this).val()).length&&(e=!1),$(this).prop("required")&&is_editor_active($(this))&&0===tinyMCE.get($(this).attr("id")).getContent().length&&(tinymce.execCommand("mceFocus",!1,"consent"),e=!1),$(this).attr("maxlength")&&$(this).val().length>$(this).attr("maxlength")&&(e=!1,n="Exceeds Maximum length ("+$(this).attr("maxlength")+")"),$(this).attr("minlength")&&$(this).val().length>$(this).attr("minlength")&&(e=!1,n="Too short! (minimum: "+$(this).attr("minlength")+")"),null!==$(this).val()&&$(this).val().length>0&&"email"===$(this).attr("type")&&!checkemail($(this).val())&&(n="Invalid email",e=!1),e||($(this).addClass("wrongField"),$(this).parent("div").append("<div class='inputFeedback' style='display: none;'></div>"),$(this).parent("div").find(".inputFeedback").animate({width:"toggle"})),i=e?i:e});var a=e.find('input[type="checkbox"]'),s={},o=!0;a.each(function(){var t=this.name;void 0===s[t]&&(o=e.find("input[name='"+t+"']:checked").length>0,o||e.find("input[name='"+t+"']").last().addClass("wrongField").after("<div class='inputFeedback' style='display: none;'>*</div>").next(".inputFeedback").animate({width:"toggle"}),s[t]=t)}),i=i&&o;var r=e.find("input[name=conf_password]");if(r.length>0){var u=e.find("input[name=password]").val();u!==r.val()&&(r.addClass("wrongField"),n="Passwords must match",i=!1)}return i||(e.find(".feedbackSubmit").remove(),t.before("<div class='feedbackSubmit' style='display: none;'>"+n+"</div>"),e.find(".feedbackSubmit").animate({width:"toggle"},350)),e.find("input.wrongField:first").focus(),i},checkemail=function(e){var t=new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);return t.test(e)},showfeedback=function(e,t,i){var n="undefined"==typeof t?".feedback":t;return i=void 0===i||i,$(n).html(e).fadeIn(1e3).delay(3e3),i&&$(n).fadeOut(1e3),!1};$(document).ready(function(){$("body").on("click",".processform",function(e){e.preventDefault();var t=$(this),i=t.length>0?$(t[0].form):$(),n=i.attr("action");if(t.hasClass("reload"))var a=function(e){e.status===!0&&location.reload()};else a=!1;processForm(i,a,n)}).on("blur","input, select, textarea",function(e){if($(this).is(":valid")&&null!==$(this).val()&&$(this).val().length>0){var t=$(this).siblings(".inputFeedback");void 0!==t&&t.fadeOut(200),$(this).removeClass("wrongField")}}).on("click",".feedbackForm",function(){removeFeedBack($(".feedbackFormTarget#"+$(this).attr("id")))})});