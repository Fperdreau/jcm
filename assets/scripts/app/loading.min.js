function getPage(e,t){var i=getParams();void 0===e&&(e=void 0===i.page?"home":i.page),t=void 0===t?parseurl():t,t=t!==!1&&""!==t&&t;var n=$("main");i.getPage=e,jQuery.ajax({url:"php/router.php?controller=Page&action=getPage&page="+e,type:"POST",async:!0,beforeSend:function(){loadingDiv(n)},complete:function(){removeLoading(n)},success:function(i){var n=jQuery.parseJSON(i),a={page:n.pageName},o=t===!1?"index.php?page="+e:"index.php?page="+e+"&"+t;history.pushState(a,n.pageName,o),displayPage(e,n)}})}function loadWYSIWYGEditor(){var e=$(document).find("textarea.wygiwym");$.each(e,function(e,t){CKEDITOR.instances[$(t).attr("id")]&&CKEDITOR.instances[$(t).attr("id")].destroy(),CKEDITOR.replace(t)})}function pageTransition(e){var t=$("#hidden_container"),i=t.find("#current_content");if(0===t.find("#next_content").length)return t.append('<div id="next_content"></div>'),renderSection(i,e),!0;var n=t.find("#next_content");renderSection(n,e),i.animate({"margin-left":"-100%",opacity:0},1e3,function(){var e=$(this).siblings("#next_content");e.attr("id","current_content"),e.after('<div id="next_content"></div>'),$(this).remove()})}function renderSection(e,t){var i='<div class="wrapper"><div id="section_title"></div><div id="section_content"></div></div>';e.html(i),e.find("#section_content").html(t.content),e.find("#section_title").html(t.header)}function loadingDiv(e){e.css("position","relative").append("<div class='loadingDiv' style='width: 100%; height: 100%;'></div>").show()}function removeLoading(e){e.fadeIn(200),e.find(".loadingDiv").fadeOut(1e3).remove()}function adapt(){var e=$("#float_menu"),t=$(".topnav"),i=$(".sideMenu");i.hide(),e.hide(),$(".submenu").hide();var n=$("#sitetitle").outerWidth()+t.outerWidth()+$("#login_box").outerWidth()+10;$(window).width()<=n?(e.show(),t.hide()):(e.hide(),t.css("display","inline-block").show());var a=$(window).height(),o=$(window).width();$("#core").css("min-height",a+"px");var r=$(".modalContainer"),d=r.outerWidth(),c=d<o?d/2:0,s=d<o?50:0;r.css({"margin-left":-c+"px",left:s+"%"})}var tinymcesetup=function(e){void 0===e&&(e="tinymce"),tinyMCE.remove(),window.tinymce.dom.Event.domLoaded=!0,tinymce.init({mode:"textareas",editor_selector:e,width:"100%",height:300,plugins:["advlist autolink lists charmap print preview hr spellchecker","searchreplace wordcount visualblocks visualchars code fullscreen","save contextmenu directionality template paste textcolor"],content_css:"vendor/tinymce/tinymce/skins/lightgray/content.min.css",toolbar:"undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | l      ink image | print preview media fullpage | forecolor backcolor emoticons"}),$("."+e).each(function(){void 0!==$(this).attr("id")&&0!==$(this).attr("id").length||$(this).attr("id","tinymce_"+Math.round((new Date).getTime()+100*Math.random())),tinyMCE.execCommand("mceAddControl",!0,$(this).attr("id"))})},loadCalendarSessions=function(){$("#ui-datepicker-div").remove(),jQuery.ajax({url:"php/router.php?controller=Calendar&action=getParams",type:"POST",async:!0,success:function(e){var t=jQuery.parseJSON(e);inititdatepicker(t)}})},loadCalendarSubmission=function(){$("#ui-datepicker-div").remove(),jQuery.ajax({url:"php/router.php?controller=Calendar&action=getParams",type:"POST",async:!0,success:function(e){var t=jQuery.parseJSON(e);init_submission_calendar(t)}})},loadCalendarAvailability=function(){var e=$("#availability_calendar");e.length>0&&void 0!==e&&(e.css({position:"relative","min-height":"200px"}),jQuery.ajax({url:"php/router.php?controller=Calendar&action=getParams",type:"POST",async:!0,beforeSend:function(){loadingDiv(e)},complete:function(){removeLoading(e)},success:function(t){e.hasClass("hasDatepicker")&&e.datepicker("destroy"),initAvailabilityCalendar(jQuery.parseJSON(t))}}))},Editor="CKEditor",displayPage=function(e,t){var i=t.plugins;pageTransition(t),showPlugins(e,i),loadWYSIWYGEditor(),loadCalendarSessions(),loadCalendarAvailability(),loadCalendarSubmission()},parseurl=function(){var e=window.location.search.substring(1),t=e.split("&");return t=t.slice(1,t.length),t=t.join("&")};getParams=function(){var e=window.location.href,t=e.split("?");if(1===t.length)return{};for(var i=decodeURIComponent(t[1]).split("&"),n={},a=0;a<i.length;a++){var o=i[a].split("=");n[o[0]]=o[1]}return n},$(document).ready(function(){$(window).resize(function(){adapt()}),$("body").ready(function(){getPage(),adapt()})});