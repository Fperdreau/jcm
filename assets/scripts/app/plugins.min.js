function getPlugins(a,b){jQuery.ajax({url:"php/form.php",type:"POST",data:{get_plugins:true,page:a},async:true,success:function(d){var c=jQuery.parseJSON(d);b(a,c)}})}function showPlugins(e,a){var c;var b=e.split("/");for(c in a){if(a.hasOwnProperty(c)){var d=a[c];if(d.page===b[b.length-1]){$(".plugins").fadeOut(200).append("<section>"+d.display+"</section>").fadeIn(200)}}}}function install(c){var b=$(this).attr("data-name");var a=$(this).attr("data-controller");var d=$(this).attr("data-action");var e=$(this).closest(".plugDiv");jQuery.ajax({url:"php/router.php?controller="+a+"&action="+d,type:"POST",data:{name:b},async:true,beforeSend:function(){if(d==="install"){$(c).removeClass("installBtn")}else{$(c).removeClass("uninstallBtn")}$(c).addClass("loadBtn")},success:function(f){validsubmitform(e,f,function(g){if(g.status===true){var h=(d==="install")?"uninstallBtn":"installBtn";var i=(d==="install")?"uninstall":"install";$(c).attr("data-op",i).removeClass("loadBtn").addClass(h)}})}})}function execute(d,i){var b=d.data("name");var f=d.data("controller");var e=d.data("action");var a=d.closest(".plugDiv");var h=e+"Btn";var c=(e===i[0])?i[1]:i[0];var g=c+"Btn";jQuery.ajax({url:"php/router.php?controller="+f+"&action="+e,type:"POST",data:{name:b},async:true,beforeSend:function(){$(d).removeClass(h);$(d).addClass("loadBtn")},success:function(j){validsubmitform(a,j,function(k){if(k.status===true){$(d).attr("data-action",e).removeClass("loadBtn").addClass(g)}})}})}function showLogs(b){var a=b.attr("id");var c=$(".plugLog#"+a);if(!c.is(":visible")){jQuery.ajax({type:"post",url:"php/form.php",data:{showLog:a},success:function(e){var d=jQuery.parseJSON(e);$(".plugLog#"+a).html(d).toggle()}})}else{c.toggle()}}function deleteLogs(b){var a=b.attr("id");var c=b.closest(".plugDiv");jQuery.ajax({type:"post",url:"php/form.php",data:{deleteLog:a},async:true,success:function(d){validsubmitform(c,d)}})}function runTask(a){var b=a.attr("data-cron");var c=a.closest(".plugDiv");jQuery.ajax({url:"php/router.php?controller=Tasks&action=execute&name="+b,type:"POST",data:{name:b},async:true,beforeSend:function(){$(a).toggleClass("runBtn loadBtn")},complete:function(){$(a).toggleClass("loadBtn runBtn")},success:function(d){validsubmitform(c,d)}})}function stopTask(a){var b=a.attr("data-cron");var c=a.closest(".plugDiv");jQuery.ajax({url:"php/router.php?controller=Tasks&action=stop&name="+b,type:"POST",data:{name:b},async:true,beforeSend:function(){$(a).toggleClass("runBtn loadBtn")},complete:function(){$(a).toggleClass("loadBtn runBtn")},success:function(d){c.find(".task_running_icon").toggleClass("running not_running");validsubmitform(c,d)}})}$(document).ready(function(){$("<style>").prop("type","text/styles").html("            .valid_input {                background: rgba(0, 200, 0, .5);            }            .wrong_input {                background: rgba(200, 0, 0, .5);            }").appendTo("head");$(document).on("input",".modSettings",function(f){f.preventDefault();var a=$(this);var c=$(this).data("option");var b=$(this).data("name");var g=$(this).data("op");var d=$(this).val();jQuery.ajax({url:"php/form.php",type:"POST",data:{modSettings:b,option:c,op:g,value:d},async:true,success:function(h){var e=jQuery.parseJSON(h);if(e===true||e!==false){if(g=="cron"){$("#cron_time_"+b).html(e)}a.addClass("valid_input");setTimeout(function(){a.removeClass("valid_input")},500)}else{a.addClass("wrong_input");setTimeout(function(){a.removeClass("wrong_input")},500)}}})}).on("click",".modCron",function(b){b.preventDefault();b.stopImmediatePropagation();var a=$(this).length>0?$($(this)[0].form):$();processForm(a,function(c){if(c.status){$("#cron_time_"+a.find('input[name="name"]').val()).html(c.msg).fadeIn(200)}})}).on("click",".installDep",function(a){a.preventDefault();execute($(this),["install","uninstall"])}).on("click",".activateDep",function(a){a.preventDefault();execute($(this),["activate","deactivate"])}).on("click",".showLog",function(a){a.preventDefault();showLogs($(this))}).on("click",".deleteLog",function(a){a.preventDefault();deleteLogs($(this))}).on("click",".run_cron",function(a){a.preventDefault();runTask($(this))}).on("click",".stop_cron",function(a){a.preventDefault();stopTask($(this))})});