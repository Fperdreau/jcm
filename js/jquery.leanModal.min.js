(function(a){a.fn.extend({leanModal:function(c){var d={top:100,overlay:0.5,closeButton:".modal_close",load:true,callback:undefined};var b=a("<div id='lean_overlay'></div>");if(a("#lean_overlay").length===0){a("body").append(b)}c=a.extend(d,c);return this.click(function(h){var j=c;var i=a("#lean_overlay");var f=a(this).data("modal");f=(f===undefined)?"#modal":f;var g=a(this).data("section");i.click(function(){close_modal(f)});a(j.closeButton).click(function(){close_modal(f)});i.css({display:"block",opacity:0}).fadeTo(200,j.overlay);if(j.load===true){load_section(a(this).data(),j.callback)}h.preventDefault();h.stopPropagation()})}})})(jQuery);function close_modal(a){a=(a===undefined)?".modalContainer":a;$("#lean_overlay").fadeOut(200);$(a).css({display:"none"})}function show_section(e,d){d=d===undefined?"modal":d;var c=$(".modalContainer#"+d);var a=c.find(".popupBody");var g=$(".modalContainer#"+d+" .modal_section");var b=null;g.each(function(){if($(this).is(":visible")||$(this).hasClass("current_section")){$(this).addClass("previous_section");$(this).removeClass("current_section");b=$(this).attr("id")}else{if($(this).hasClass("previous_section")){$(this).removeClass("previous_section")}}});if(c.find(".back_btn").length>0){c.find(".back_btn").remove()}g.hide();if(b!==null&&b.length>0){var f="<div class='back_btn' data-prev='"+b+"'></div>";c.find(".float_buttons_container").prepend(f)}if(a.children(".modal_section#"+e).length>0){transition(c,a.children(".modal_section#"+e));a.children(".modal_section#"+e).addClass("current_section")}}function animate_before(b){var a=50;var c=50;b.css({height:c+"px",width:a+"px"});loadingDiv(b)}function transition(h,g){h.append("<div class='blankDiv'></div>");var e=realDim(g);var d=realDim(g.find(".popupContent"));var i=realDim(g.find(".popupHeader"));var f=realDim(h);var j=$(window).height();var c=$(window).width();var b=Math.round(0.9*j)-i.height;var a=Math.min(Math.max(e.height,d.height),b);h.find(".popupContent").css({overflow:"hidden","max-height":a+"px"});h.css({display:"block",position:"absolute","z-index":11000,left:Math.round((0.5*c)-(0.5*f.width))+"px",top:Math.round((0.5*j)-(0.5*f.height))+"px"}).fadeTo(200,1).animate({top:Math.round(0.5*(j-a))+$(document).scrollTop()+"px",left:Math.round(0.5*(c-parseInt(f["max-width"])))+"px",width:f["max-width"],"margin-left":0},300,function(){$(this).find(".popupContent").css("overflow-y","auto");g.show();$(this).find(".blankDiv").css({opacity:0,transition:".15s ease-in-out"}).remove()})}function realDim(b){var c=b.clone();c.css({visibility:"hidden","max-height":"none"});$("body").append(c);var a={height:c.outerHeight(true),width:c.outerWidth(),"max-width":c.css("max-width"),"max-height":c.css("max-height")};c.remove();return a}function load_section(d,e){var c=(d.modal===undefined)?"modal":d.modal;var b=$(".modalContainer#"+c).find(".popupBody");var a=b.find(".modal_section#"+d.section);if(a.length>0){a.remove()}d.get_modal=true;jQuery.ajax({url:"php/form.php",data:d,type:"post",beforeSend:function(){animate_before($(".modalContainer#"+c))},complete:function(){removeLoading($(".modalContainer#"+c))},success:function(g){var f=jQuery.parseJSON(g);b.append(f);show_section(d.section,c);if(e!==undefined){e()}},error:function(){removeLoading($(".modalContainer#"+c))}})}function go_to_previous(b,c){c=c===undefined?"modal":c;var a=$(".modalContainer#"+c).find(".popupBody");var d;if(b===undefined){d=$(".modalContainer#"+c+" .previous_section")}else{d=$(".modalContainer#"+c+" .modal_section#"+b)}if(d.length===0){return false}show_section(d.attr("id"),c)}function go_to_section(d){var c=(d.modal===undefined)?"modal":d.modal;var b=$(".modalContainer#"+c).find(".popupBody");var a=b.find(".modal_section#"+d.section);if(a.length>0){show_section(d.section,c)}else{d.get_modal=true;jQuery.ajax({url:"php/form.php",data:d,type:"post",complete:function(){removeLoading($(".modalContainer#"+c))},success:function(f){var e=jQuery.parseJSON(f);b.append(e);show_section(d.section,c)}})}}function trigger_modal(a,b,c){if(b===undefined){b=true}if(a.data("leanModal")===undefined){a.leanModal({top:50,overlay:0.6,closeButton:".modal_close",load:b,callback:c});a.data("leanModal",true);a.click()}}function in_modal(a,b){b=(b===undefined)?"modal":b;return $(".modalContainer#"+b).find(a).length>0};