var processForm=function(c,f,b,d){if(!checkform(c)){return false}var e=c.serializeArray();var a=c.find(".tinymce");if(a.length>0&&a!==undefined){a.each(function(){var i=$(this).attr("id");var h=$(this).attr("name");var g=tinyMCE.get(i).getContent();e=modArray(e,h,g)})}b=c.attr("action");processAjax(c,e,f,b,d)};var processAjax=function(d,c,e,a,b){jQuery.ajax({url:a,type:"POST",async:true,data:c,beforeSend:function(){loadingDiv(d)},complete:function(){removeLoading(d)},success:function(f){e=(e===undefined)?false:e;validsubmitform(d,f,e,b)},error:function(){removeLoading(d)}})};var validsubmitform=function(c,f,g,a){c=(c===undefined)?$("body"):c;var i=jQuery.parseJSON(f);g=(g===undefined)?false:g;a=(a===undefined)?2000:a;var d=false;if(i.status===true){d=(i.msg===undefined)?"<p class='sys_msg success'>DONE!</p>":"<p class='sys_msg success'>"+i.msg+"</p>"}else{if(i.status!==undefined){d=(i.msg===undefined)?"<p class='sys_msg warning'>Oops, something has gone wrong!</p>":"<p class='sys_msg warning'>"+i.msg+"</p>"}}if(d!==false){var b=c.width();var h=c.height();c.append("<div class='feedbackForm'></div>");var e=$(".feedbackForm");e.css({width:b+"px",height:h+"px"}).html(d).fadeIn(200);setTimeout(function(){e.fadeOut(200).remove();if(g!==false){g(i)}},a)}else{if(g!==false){g(i)}}};var checkform=function(b){var a=true;b.closest(".inputFeedback").remove();var c="* Required";b.find("input,select,textarea").not('input[type="submit"]').each(function(){$(this).removeClass("wrongField");var j=true;if($(this).is(":visible")&&$(this).prop("required")&&$.trim($(this).val()).length===0){j=false}if($(this).prop("required")&&$(this).hasClass("tinymce")&&tinyMCE.get($(this).attr("id")).getContent().length===0){tinymce.execCommand("mceFocus",false,"consent");j=false}if($(this).attr("maxlength")&&$(this).val().length>$(this).attr("maxlength")){j=false;c="Exceeds Maximum length ("+$(this).attr("maxlength")+")"}if($(this).attr("minlength")&&$(this).val().length>$(this).attr("minlength")){j=false;c="Too short! (minimum: "+$(this).attr("minlength")+")"}if($(this).val().length>0&&$(this).attr("type")=="email"&&!checkemail($(this).val())){c="Invalid email";j=false}if(!j){$(this).addClass("wrongField");$(this).parent("div").append("<div class='inputFeedback' style='display: none;'>*</div>");$(this).parent("div").find(".inputFeedback").animate({width:"toggle"})}a=(!j)?j:a});var f=b.find('input[type="checkbox"]');var h={};var g=true;f.each(function(){var j=this.name;if(h[j]==undefined){g=b.find("input[name='"+j+"']:checked").length>0;if(!g){b.find("input[name='"+j+"']").last().addClass("wrongField").after("<div class='inputFeedback' style='display: none;'>*</div>").next(".inputFeedback").animate({width:"toggle"})}h[j]=j}});a=a&&g;var d=b.find("input[name=conf_password]");if(d.length>0){var i=b.find("input[name=password]").val();if(i!==d.val()){d.addClass("wrongField");c="Passwords must match";a=false}}if(!a){var e=b.find('button[type="submit"], input[type="submit"]');b.find(".feedbackSubmit").remove();e.before("<div class='feedbackSubmit' style='display: none;'>"+c+"</div>");b.find(".feedbackSubmit").animate({width:"toggle"},350)}b.find("input.wrongField:first").focus();return a};var checkemail=function(a){var b=new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);return b.test(a)};var showfeedback=function(c,a){var b=(typeof a==="undefined")?".feedback":".feedback#"+a;$(b).html(c).fadeIn(1000).delay(3000).fadeOut(1000);return false};function modArray(c,d,b){var a;for(a=0;a<c.length;++a){if(c[a].name==d){c[a].value=b;break}}return c}$(document).ready(function(){$("body").on("click",".processform",function(c){c.preventDefault();c.stopPropagation();var a=$(this);var b=a.length>0?$(a[0].form):$();processForm(b)})});