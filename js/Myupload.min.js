var getdrop=function(g){var d=g.dataTransfer||(g.originalEvent&&g.originalEvent.dataTransfer);var c=g.target.files||(d&&d.files);if(c){var a=c.length;for(var b=0;b<a;++b){var f=new FormData();f.append("file[]",c[b]);processUpl(f)}}};var processUpl=function(c){var a=$(".upl_container");var e=a.attr("id");var d=new AnimateBack(a);var b=$("form#"+e);jQuery.ajax({type:"POST",url:"php/upload.php",headers:{"Cache-Control":"no-cache"},data:c,contentType:false,processData:false,beforeSend:d.start(),complete:d.stop(),success:function(g){var f=jQuery.parseJSON(g);a.find(".upl_errors").hide();var h=f.error;if(h===true){if(b.length>0){b.append(f.input)}else{console.warn("No form linked to the uploader")}$(".upl_filelist").append(f.file_div)}else{a.find(".upl_errors").addClass("warning").html(h).show()}},error:function(f){a.find(".upl_errors").addClass("warning").html(f.statusText).show()}})};var sendAjax=function(d,c,e,a){a=(a===undefined)?"php/form.php":a;var b=new AnimateBack(d);jQuery.ajax({url:a,type:"POST",async:true,data:c,beforeSend:b.start(),complete:b.stop(),success:function(g){var f=jQuery.parseJSON(g);e(f)}})};function AnimateBack(a){this.el=a;this.interval=0;this.gradient_percent=0;this.interval_value=5;this.time_interval=50;this.timer=null;this.anim=function(){if(this.interval==20){this.interval=0;this.gradient_percent=0}this.gradient_percent+=this.interval_value;this.el.css("background","linear-gradient(to right, rgba(64,64,64,1) "+this.gradient_percent+"%,rgba(0,0,0,0) 100%)");this.interval++};this.start=function(){if(this.timer===null){this.timer=setInterval((function(b){return function(){b.anim()}})(this),this.time_interval)}};this.stop=function(){var b=this;if(b.timer!==null){setTimeout(function(){clearInterval(b.timer);b.el.css("background-color","rgba(68,68,68,1)");b.timer=null},1000)}}}$(document).ready(function(){var a=0;$(".mainbody").on("dragenter",".upl_container",function(b){b.stopPropagation();b.preventDefault();a++;$(".upl_container").addClass("dragging")}).on("dragleave",".upl_container",function(b){b.stopPropagation();b.preventDefault();a--;if(a===0){$(".upl_container").removeClass("dragging")}}).on("dragover",".upl_container",function(b){b.stopPropagation();b.preventDefault()}).on("drop",".upl_container",function(b){b.stopPropagation();b.preventDefault();getdrop(b);$(".upl_container").removeClass("dragging")}).on("click",".upl_btn",function(){$(".upl_input").click()}).on("change",".upl_input",function(f){f.preventDefault();var c=$(".upl_input")[0];for(var b=0;b<c.files.length;++b){var d=new FormData();d.append("file[]",c.files[b]);processUpl(d)}}).on("click",".upl_errors",function(){$(this).fadeOut().empty()}).on("click",".del_upl",function(){var c={del_upl:true,uplname:$(this).attr("id")};var b=$(".upl_container");var d=function(e){if(e.status===true){$(".upl_info#upl_"+e.uplname).remove();$(".upl_link#"+e.uplname).remove()}else{b.find(".upl_errors").html(e.msg).addClass("warning").show()}};sendAjax(b,c,d)})});